(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51b4a57e"],{"350f":function(t,e,o){"use strict";o("5bb2")},"5bb2":function(t,e,o){},6287:function(t,e,o){"use strict";o.r(e);o("a450");var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"vte-compute-unit"},[e("div",{staticClass:"vte-compute-unit-header"},[e("el-input",{staticClass:"w-300",attrs:{placeholder:"请输入计算单元名称",clearable:""},on:{clear:t.beforeComputeUnitList},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.beforeComputeUnitList.apply(null,arguments)}},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),e("el-button",{staticClass:"ml-20",attrs:{type:"primary"},on:{click:t.beforeComputeUnitList}},[t._v("查询")]),e("el-button",{staticClass:"right",attrs:{type:"primary"},on:{click:t.addComputeUnit}},[t._v("新增")])],1),e("div",{staticClass:"vte-compute-unit-main"},[e("el-table",{attrs:{data:t.computeData,height:"100%","highlight-current-row":"","header-cell-style":t.getRowClass}},[e("el-table-column",{attrs:{prop:"jsdydm",label:"计算单元代码"}}),e("el-table-column",{attrs:{prop:"jsdymc",label:"计算单元名称","show-overflow-tooltip":"","min-width":"120"}}),e("el-table-column",{attrs:{prop:"jsgz",label:"计算规则","show-overflow-tooltip":"","min-width":"120"}}),e("el-table-column",{attrs:{prop:"gzms",label:"规则描述","min-width":"100","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"dbcofigSever",label:"数据库连接","show-overflow-tooltip":"","min-width":"120"}}),e("el-table-column",{attrs:{label:"记录状态","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[t._v("\n          "+t._s("0"===o.jlzt?"启用":"停用")+"\n        ")]}}])}),e("el-table-column",{attrs:{label:"操作","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(o){var a=o.row;return["0"===a.jlzt?e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.updateUnitStatus(a)}}},[t._v("停用")]):t._e(),"0"!==a.jlzt?e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateUnitStatus(a)}}},[t._v("启用")]):t._e(),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editComputeUnit(a)}}},[t._v("编辑")])]}}])})],1)],1),e("pagination",{attrs:{page:t.page,size:t.size,total:t.total},on:{"update:page":function(e){t.page=e},"update:size":function(e){t.size=e},getTableData:t.computeUnitList}}),e("el-dialog",{attrs:{visible:t.showDialog,title:t.dialogTitle,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showDialog=e}}},[e("el-form",{ref:"computeUnitForm",attrs:{model:t.computeFormItem,rules:t.computeUnitRules,"label-width":"110px"}},[e("el-form-item",{attrs:{label:"计算单元代码",prop:"jsdydm"}},[e("el-input",{attrs:{placeholder:"请输入计算单元代码"},model:{value:t.computeFormItem.jsdydm,callback:function(e){t.$set(t.computeFormItem,"jsdydm",e)},expression:"computeFormItem.jsdydm"}})],1),e("el-form-item",{attrs:{label:"计算单元名称",prop:"jsdymc"}},[e("el-input",{attrs:{placeholder:"请输入计算单元名称"},model:{value:t.computeFormItem.jsdymc,callback:function(e){t.$set(t.computeFormItem,"jsdymc",e)},expression:"computeFormItem.jsdymc"}})],1),e("el-form-item",{attrs:{label:"计算规则",prop:"jsgz"}},[e("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"规则示例: exec USP_VTE_GETZDMC_PAST :yljgdm,:jzlb,:jzlsh,'','',0"},model:{value:t.computeFormItem.jsgz,callback:function(e){t.$set(t.computeFormItem,"jsgz",e)},expression:"computeFormItem.jsgz"}})],1),e("el-form-item",{attrs:{label:"规则描述",prop:"gzms"}},[e("el-input",{attrs:{placeholder:"请输入规则描述"},model:{value:t.computeFormItem.gzms,callback:function(e){t.$set(t.computeFormItem,"gzms",e)},expression:"computeFormItem.gzms"}})],1),e("el-form-item",{attrs:{label:"数据连接ID",prop:"dbconfigid"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.computeFormItem.dbconfigid,callback:function(e){t.$set(t.computeFormItem,"dbconfigid",e)},expression:"computeFormItem.dbconfigid"}},t._l(t.dbConfig,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:"参数用例"}},[e("el-input",{attrs:{type:"textarea",placeholder:t.example,autosize:""},model:{value:t.testExample,callback:function(e){t.testExample=e},expression:"testExample"}})],1),e("el-form-item",{attrs:{label:"记录状态"}},[e("el-radio-group",{model:{value:t.computeFormItem.jlzt,callback:function(e){t.$set(t.computeFormItem,"jlzt",e)},expression:"computeFormItem.jlzt"}},[e("el-radio",{attrs:{label:"0"}},[t._v("启用")]),e("el-radio",{attrs:{label:"1"}},[t._v("停用")])],1)],1),t.showResult?e("el-form-item",{attrs:{label:"操作"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.drawer=!0}}},[t._v("查看测试结果")])],1):t._e()],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.testLoad},on:{click:t.testSql}},[t._v("\n        测试\n      ")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveCompteUnit}},[t._v("提交")])],1)],1),e("el-drawer",{attrs:{visible:t.drawer,direction:"rtl"},on:{"update:visible":function(e){t.drawer=e}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("h4",[t._v("测试结果")])]),e("div",{staticClass:"drawer-pd"},[e("h3",[t._v("执行SQL:")]),e("span",[t._v(t._s(t.execSql))]),e("h3",{staticClass:"mt-20"},[t._v("结果集(仅top 100):")]),e("ul",t._l(t.execResult,(function(o,a){return e("li",{key:a,staticClass:"drawer-li"},[t._v("\n          "+t._s(o)+"\n        ")])})),0)])])],1)},n=[],i=(o("ac67"),o("1bc7"),o("32ea"),o("7afe"),o("8dee"),o("824a")),r=o("f13c"),s=o("ae5e"),c=o("acac"),l=o("2ad3"),u=o("e0e5"),p=o("fd63"),m=o("e4a1"),f=o("6407");function d(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function b(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?d(Object(o),!0).forEach((function(e){Object(i["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function g(t){var e=h();return function(){var o,a=Object(u["a"])(t);if(e){var n=Object(u["a"])(this).constructor;o=Reflect.construct(a,arguments,n)}else o=a.apply(this,arguments);return Object(l["a"])(this,o)}}function h(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var y=function(t){Object(c["a"])(o,t);var e=g(o);function o(){var t;return Object(r["a"])(this,o),t=e.apply(this,arguments),t.page=1,t.size=10,t.total=0,t.searchKey="",t.computeData=[],t.computeFormItem={},t.showDialog=!1,t.dialogTitle="",t.computeUnitRules={jsdydm:[{required:!0,message:"请输入计算单元代码",trigger:"blur"}],jsdymc:[{required:!0,message:"请输入计算单元名称",trigger:"blur"}],jsgz:[{required:!0,message:"请输入计算规则",trigger:"blur"}],gzms:[{required:!0,message:"请输入规则描述",trigger:"blur"}],dbconfigid:[{required:!0,message:"请选择数据连接",trigger:"blur"}]},t.testExample="",t.dbConfig=[],t.example='参数示例: {\n         "yljgdm": "xxx",\n          "jzlb": "xx",\n          "jzlsh": "xx"\n          }"',t.execSql="",t.execResult=[],t.drawer=!1,t.showResult=!1,t.testLoad=!1,t}return Object(s["a"])(o,[{key:"changeLoad",value:function(t){t||(this.showResult=t)}},{key:"mounted",value:function(){this.computeUnitList(),this.dbConfigList()}},{key:"getRowClass",value:function(){return"font-weight:blod; color:black; border-bottom: 1px RGBA(199, 199, 199, 1) solid;"}},{key:"dbConfigList",value:function(){var t=this;this.$api.dbConfigList().then((function(e){t.dbConfig=e.data||[]})).catch((function(){}))}},{key:"beforeComputeUnitList",value:function(){this.page=1,this.computeUnitList()}},{key:"computeUnitList",value:function(){var t=this,e={searchKey:this.searchKey,page:this.page,size:this.size};this.$api.getPage(e).then((function(e){var o=e.data||{};t.computeData=o.content||[],t.total=o.totalElements||0})).catch((function(){}))}},{key:"updateUnitStatus",value:function(t){var e=this,o={id:t.lcjsgzkey,status:"0"===t.jlzt?"1":"0"};this.$api.updateUnitStatus(o).then((function(){var o="0"===t.jlzt?"停用成功":"启用成功";e.$message({message:o,type:"success"}),e.computeUnitList()})).catch((function(){}))}},{key:"saveCompteUnit",value:function(){var t=this;this.$refs.computeUnitForm.validate((function(e){e&&t.$api.saveCompteUnit(t.computeFormItem).then((function(){t.$message({message:"保存成功",type:"success"}),t.showDialog=!1,t.computeUnitList()})).catch((function(){}))}))}},{key:"addComputeUnit",value:function(){this.computeFormItem={lcjsgzkey:-1,jsdydm:"",jsdymc:"",jsgz:"",gzms:"",dbconfigid:"",jlsj:"",gxrq:"",jlzt:"0"},this.dialogTitle="新增计算单元",this.showDialog=!0,this.$refs["computeUnitForm"]&&this.$refs.computeUnitForm.resetFields()}},{key:"editComputeUnit",value:function(t){this.computeFormItem=b({},t),this.dialogTitle="编辑计算单元",this.showDialog=!0,this.$refs["computeUnitForm"]&&this.$refs.computeUnitForm.resetFields()}},{key:"testSql",value:function(){var t=this;this.$refs.computeUnitForm.validate((function(e){e&&(""===t.testExample?t.$confirm("确定不需要填写参数用例?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){t.test()})).catch((function(){})):t.test())}))}},{key:"test",value:function(){var t=this;this.testLoad=!0;var e={sql:this.computeFormItem.jsgz,dbConfigId:this.computeFormItem.dbconfigid,params:JSON.stringify(this.testExample.replace(/\n/g,""))};this.$api.testSql(e).then((function(e){var o=e.data||{};t.execSql=o.execSql||"",t.execResult=o.result||[],t.testLoad=!1,t.showResult=!0})).catch((function(){t.testLoad=!1}))}}]),o}(m["c"]);Object(p["a"])([Object(m["d"])("showDialog")],y.prototype,"changeLoad",null),y=Object(p["a"])([Object(m["a"])({name:"VteComputeUnit",components:{pagination:f["a"]}})],y);var v=y,j=v,z=(o("350f"),o("0b56")),O=Object(z["a"])(j,a,n,!1,null,"8602188c",null);e["default"]=O.exports},6407:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total,"pager-count":t.pagerCount},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})},n=[],i=(o("7afe"),o("f13c")),r=o("ae5e"),s=o("acac"),c=o("2ad3"),l=o("e0e5"),u=o("fd63"),p=o("e4a1");function m(t){var e=f();return function(){var o,a=Object(l["a"])(t);if(e){var n=Object(l["a"])(this).constructor;o=Reflect.construct(a,arguments,n)}else o=a.apply(this,arguments);return Object(c["a"])(this,o)}}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var d=function(t){Object(s["a"])(o,t);var e=m(o);function o(){return Object(i["a"])(this,o),e.apply(this,arguments)}return Object(r["a"])(o,[{key:"currentPage",get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},{key:"pageSize",get:function(){return this.size},set:function(t){this.$emit("update:size",t)}},{key:"handleSizeChange",value:function(t){this.currentPage=1,this.$emit("getTableData")}},{key:"handleCurrentChange",value:function(t){this.$emit("getTableData")}}]),o}(p["c"]);Object(u["a"])([Object(p["b"])({required:!0})],d.prototype,"total",void 0),Object(u["a"])([Object(p["b"])({default:1})],d.prototype,"page",void 0),Object(u["a"])([Object(p["b"])({default:10})],d.prototype,"size",void 0),Object(u["a"])([Object(p["b"])({default:7})],d.prototype,"pagerCount",void 0),Object(u["a"])([Object(p["b"])({default:function(){return[10,20,30,50]}})],d.prototype,"pageSizes",void 0),Object(u["a"])([Object(p["b"])({default:"total, sizes, prev, pager, next, jumper"})],d.prototype,"layout",void 0),d=Object(u["a"])([Object(p["a"])({name:"pagination"})],d);var b=d,g=b,h=(o("84c7"),o("0b56")),y=Object(h["a"])(g,a,n,!1,null,"7e267c7f",null);e["a"]=y.exports},"84c7":function(t,e,o){"use strict";o("f180")},f180:function(t,e,o){}}]);