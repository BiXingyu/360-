(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01ad0397"],{"13a1":function(t,e,n){"use strict";n.r(e);n("a450");var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"login-container"},[e("div",{staticClass:"login"},[e("div",{staticClass:"left"}),e("div",{staticClass:"right flex flex-v"},[e("div",{staticClass:"icon-login"}),e("h3",{staticClass:"title"},[t._v("后台管理系统")]),e("el-form",{ref:"loginForm",class:["flex-1","flex","flex-v","flex-pack-justify-around",{"form-margin":t.productList.length<2&&t.hosptailList.length<2}],attrs:{model:t.loginForm,"label-position":"left","label-width":"0"}},[e("el-form-item",{attrs:{prop:"account"}},[e("el-input",{staticClass:"user-input",attrs:{type:"text",size:"small","auto-complete":"off",placeholder:"请输入账号","prefix-icon":"el-icon-user"},model:{value:t.loginForm.account,callback:function(e){t.$set(t.loginForm,"account",e)},expression:"loginForm.account"}})],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.productList.length>1,expression:"productList.length > 1"}],attrs:{prop:"productId"}},[e("el-select",{staticClass:"form-select",attrs:{size:"small",placeholder:"请选择产品"},model:{value:t.loginForm.productId,callback:function(e){t.$set(t.loginForm,"productId",e)},expression:"loginForm.productId"}},t._l(t.productList,(function(t){return e("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})),1)],1),e("el-form-item",[e("el-button",{class:["login-btn",{"btn-margin":t.productList.length<2&&t.hosptailList.length<2}],attrs:{type:"primary",loading:t.logining,disabled:!t.hosptailList.length&&!t.productList.length},on:{click:t.handleSubmit}},[t._v("\n            登录\n          ")])],1)],1)],1),e("div",{staticClass:"versoin"},[t._v("\n      © 2019 Winning Health 版权所有\n    ")])])])},r=[],i=(n("7afe"),n("e5b4"),n("1bc7"),n("fc02"),n("d91d"),n("f13c")),a=n("ae5e"),c=n("acac"),s=n("2ad3"),u=n("e0e5"),l=n("fd63"),f=n("e4a1"),d=n("2da9");function h(t){var e=p();return function(){var n,o=Object(u["a"])(t);if(e){var r=Object(u["a"])(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(s["a"])(this,n)}}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var g=function(t){Object(c["a"])(n,t);var e=h(n);function n(){var t;return Object(i["a"])(this,n),t=e.apply(this,arguments),t.logining=!1,t.loginForm={account:"",productId:"01"},t.hosptailList=[],t.productList=[],t.params=[],t.baseSysVersion="",t}return Object(a["a"])(n,[{key:"created",value:function(){this.$store.commit("SET_TOKEN",""),this.listAllProducts(),this.getMasterInstitution(),this.getSystemVersion(),this.listAllInstitutions()}},{key:"mounted",value:function(){this.getRequsestSso()}},{key:"listAllInstitutions",value:function(){var t=this;this.$api.listAllInstitutions().then((function(e){t.hosptailList=e.data||[]})).catch((function(t){}))}},{key:"getRequsestSso",value:function(){this.params=this.getRequestParamMap(decodeURI(window.location.search));var t=this.params["user"];console.log(t),this.params[window.CONFIG.casCookie]&&(this.setCookie(window.CONFIG.casCookie,this.params[window.CONFIG.casCookie],0),this.loginForm.account=t,this.handleSubmit())}},{key:"setCookie",value:function(t,e,n){if(0!==n){var o=24*n*60*60*1e3,r=new Date(+new Date+o);document.cookie=t+"="+escape(e)+";expires="+r.toUTCString()}else document.cookie=t+"="+escape(e)}},{key:"getRequestParamMap",value:function(t){var e=[];if(-1!==t.indexOf("?"))for(var n=t.substr(1).split("&"),o=0;o<n.length;o++)e[n[o].split("=")[0]]=unescape(n[o].split("=")[1]);return e}},{key:"listAllProducts",value:function(){var t=this;this.$api.listAllProducts().then((function(e){t.productList=e.data||[],t.$store.commit("SET_PRODUCT_LIST",t.productList),1===t.productList.length&&(t.loginForm.productId=t.productList[0].code)})).catch((function(t){}))}},{key:"getMasterInstitution",value:function(){var t=this;this.$api.getMainInstitution().then((function(e){console.log(e.data),t.$store.commit("SET_MASTER_INSTITUTION",e.data)})).catch((function(t){}))}},{key:"getSystemVersion",value:function(){var t=this;this.$api.getSystemVersion().then((function(e){t.$store.commit("SET_SYSTEM_VERSION",e.data),t.baseSysVersion=e.data})).catch((function(t){}))}},{key:"handleSubmit",value:function(){var t=this;this.$refs.loginForm.validate((function(e){if(!e)return!1;t.logining=!0;var n={usercode:d["Base64"].encode(t.loginForm.account),productCode:t.loginForm.productId};t.$api.casloginAdmin(n).then((function(e){var o=e.data||{};if(o.token){t.$store.commit("SET_TOKEN",o.token);var r=o.productList||[];r.length||t.$message.error("该账号未配置任何菜单，请更换账号！");var i=0;if(r.forEach((function(e){i+=e.menuList.length;var n=t.productList.find((function(t){return t.code===e.code}))||{};e.code===t.loginForm.productId&&t.$store.commit("SET_SYSTEM_VERSION",n.version||""),"00"===e.code?t.$set(e,"version",t.baseSysVersion||""):t.$set(e,"version",n.version||"")})),i){t.$store.commit("SET_USER_ACCOUNT",t.loginForm.account),t.$store.commit("SET_USER_NAME",o.fullname||""),t.$store.commit("SET_HOSPITAL_LIST",t.hosptailList),t.hosptailList.length&&t.$store.commit("SET_CONFIG_HOSPITAL_ID",t.hosptailList[0].code),t.$store.commit("SET_ACTIVE_PRO_ID",n.productCode),t.$store.commit("SET_MENU_LIST",r),t.$store.commit("SET_USER_CODE",o.usercode||""),sessionStorage.setItem("hasLogin",JSON.stringify(1));var a=r.find((function(t){return t.code===n.productCode})).menuList;if(null==a)t.$message.error("该账号未配置该产品菜单，请更换产品！"),t.logining=!1;else{if(null==a[0].redirect||""===a[0].redirect)return t.$message.error("菜单重定向错误，请联系管理员！"),void(t.logining=!1);t.$router.push(a[0].redirect)}}else t.$message.error("该账号未配置任何菜单，请更换账号！"),t.logining=!1}else t.$message.error("token未获取，请联系管理员！")})).catch((function(e){t.logining=!1}))}))}}]),n}(f["c"]);g=Object(l["a"])([Object(f["a"])({name:"casRedirect"})],g);var m=g,v=m,S=(n("5419"),n("0b56")),y=Object(S["a"])(v,o,r,!1,null,"d2355cd2",null);e["default"]=y.exports},"2da9":function(t,e,n){(function(n){var o,r;(function(e,n){t.exports=n(e)})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n?n:this,(function(n){"use strict";n=n||{};var i,a=n.Base64,c="2.6.4",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=function(t){for(var e={},n=0,o=t.length;n<o;n++)e[t.charAt(n)]=n;return e}(s),l=String.fromCharCode,f=function(t){if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?l(192|e>>>6)+l(128|63&e):l(224|e>>>12&15)+l(128|e>>>6&63)+l(128|63&e)}e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return l(240|e>>>18&7)+l(128|e>>>12&63)+l(128|e>>>6&63)+l(128|63&e)},d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,h=function(t){return t.replace(d,f)},p=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),o=[s.charAt(n>>>18),s.charAt(n>>>12&63),e>=2?"=":s.charAt(n>>>6&63),e>=1?"=":s.charAt(63&n)];return o.join("")},g=n.btoa&&"function"==typeof n.btoa?function(t){return n.btoa(t)}:function(t){if(t.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return t.replace(/[\s\S]{1,3}/g,p)},m=function(t){return g(h(String(t)))},v=function(t){return t.replace(/[+\/]/g,(function(t){return"+"==t?"-":"_"})).replace(/=/g,"")},S=function(t,e){return e?v(m(t)):m(t)},y=function(t){return S(t,!0)};n.Uint8Array&&(i=function(t,e){for(var n="",o=0,r=t.length;o<r;o+=3){var i=t[o],a=t[o+1],c=t[o+2],u=i<<16|a<<8|c;n+=s.charAt(u>>>18)+s.charAt(u>>>12&63)+("undefined"!=typeof a?s.charAt(u>>>6&63):"=")+("undefined"!=typeof c?s.charAt(63&u):"=")}return e?v(n):n});var A,C=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,b=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return l(55296+(n>>>10))+l(56320+(1023&n));case 3:return l((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return l((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},x=function(t){return t.replace(C,b)},F=function(t){var e=t.length,n=e%4,o=(e>0?u[t.charAt(0)]<<18:0)|(e>1?u[t.charAt(1)]<<12:0)|(e>2?u[t.charAt(2)]<<6:0)|(e>3?u[t.charAt(3)]:0),r=[l(o>>>16),l(o>>>8&255),l(255&o)];return r.length-=[0,0,2,1][n],r.join("")},I=n.atob&&"function"==typeof n.atob?function(t){return n.atob(t)}:function(t){return t.replace(/\S{1,4}/g,F)},_=function(t){return I(String(t).replace(/[^A-Za-z0-9\+\/]/g,""))},E=function(t){return x(I(t))},O=function(t){return String(t).replace(/[-_]/g,(function(t){return"-"==t?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},w=function(t){return E(O(t))};n.Uint8Array&&(A=function(t){return Uint8Array.from(_(O(t)),(function(t){return t.charCodeAt(0)}))});var T=function(){var t=n.Base64;return n.Base64=a,t};if(n.Base64={VERSION:c,atob:_,btoa:g,fromBase64:w,toBase64:S,utob:h,encode:S,encodeURI:y,btou:x,decode:w,noConflict:T,fromUint8Array:i,toUint8Array:A},"function"===typeof Object.defineProperty){var L=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",L((function(){return w(this)}))),Object.defineProperty(String.prototype,"toBase64",L((function(t){return S(this,t)}))),Object.defineProperty(String.prototype,"toBase64URI",L((function(){return S(this,!0)})))}}return n["Meteor"]&&(Base64=n.Base64),t.exports?t.exports.Base64=n.Base64:(o=[],r=function(){return n.Base64}.apply(e,o),void 0===r||(t.exports=r)),{Base64:n.Base64}}))}).call(this,n("2409"))},5419:function(t,e,n){"use strict";n("7128")},7128:function(t,e,n){}}]);