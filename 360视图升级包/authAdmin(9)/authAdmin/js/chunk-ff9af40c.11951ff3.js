(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ff9af40c"],{"0959":function(t,e,s){},"165c":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"clauses-rule"},[e("div",{staticClass:"cellManagement"},[e("cellManagement",{attrs:{content:t.key},on:{"update:content":function(e){t.key=e}}})],1),e("div",{staticClass:"flex-1 mt-10"},[e("left-clauses",{staticClass:"left",attrs:{"clauses-row":t.clausesRow},on:{"update:clausesRow":function(e){t.clausesRow=e},"update:clauses-row":function(e){t.clausesRow=e}}}),e("right-norm",{staticClass:"right",attrs:{"clauses-row":t.clausesRow,isLook:t.isLook,isDisabled:t.isDisabled},on:{"update:isLook":function(e){t.isLook=e},"update:is-look":function(e){t.isLook=e},"update:isDisabled":function(e){t.isDisabled=e},"update:is-disabled":function(e){t.isDisabled=e}}})],1)])},l=[],i=(s("7afe"),s("ae5e")),o=s("f13c"),n=s("acac"),c=s("2ad3"),u=s("e0e5"),r=s("fd63"),f=s("e4a1"),h=(s("d91d"),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"left-clauses flex flex-v"},[e("div",{staticClass:"flex flex-align-center"},[e("el-input",{staticClass:"w-300",attrs:{placeholder:"请输入条目名称",clearable:""},on:{clear:t.beforeInitClauses},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.beforeInitClauses.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("el-button",{staticClass:"ml-20",attrs:{type:"primary"},on:{click:t.beforeInitClauses}},[t._v("查询")])],1),e("div",{staticClass:"content-main flex-1 mt-10"},[e("el-table",{staticClass:"mt-10",attrs:{data:t.clausesTable,"highlight-current-row":"","header-cell-style":t.getRowClass},on:{"row-click":t.chooseClauses}},[e("el-table-column",{attrs:{prop:"tmxmmc",label:"条目名称","show-overflow-tooltip":"",width:"500px"}}),e("el-table-column",{attrs:{prop:"tmms",label:"条目描述"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.row;return[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editClauses(a)}}},[t._v("编辑")])]}}])})],1)],1),e("pagination",{attrs:{page:t.page,size:t.size,total:t.total},on:{"update:page":function(e){t.page=e},"update:size":function(e){t.size=e},getTableData:t.initswitchCard}}),e("el-dialog",{attrs:{title:"编辑",visible:t.showDialog,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(e){t.showDialog=e}}},[e("el-form",{ref:"comClausesForm",attrs:{model:t.clausesForm,"label-width":"110px",rules:t.clausesRules}},[e("el-form-item",{attrs:{label:"条目名称"}},[e("el-input",{attrs:{disabled:""},model:{value:t.clausesForm.tmxmmc,callback:function(e){t.$set(t.clausesForm,"tmxmmc",e)},expression:"clausesForm.tmxmmc"}})],1),e("el-form-item",{attrs:{label:"条目描述"}},[e("el-input",{model:{value:t.clausesForm.tmms,callback:function(e){t.$set(t.clausesForm,"tmms",e)},expression:"clausesForm.tmms"}})],1),e("el-form-item",{attrs:{label:"计算规则",prop:"jsgz"}},[[e("tree",{attrs:{allList:t.allList,optionList:t.optionList,isShow:t.isShow},on:{"update:optionList":function(e){t.optionList=e},"update:option-list":function(e){t.optionList=e},"update:isShow":function(e){t.isShow=e},"update:is-show":function(e){t.isShow=e},changeList:t.changeList}})]],2),e("el-form-item",{attrs:{label:"规则描述",prop:"jsgzms"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.clausesForm.jsgzms,callback:function(e){t.$set(t.clausesForm,"jsgzms",e)},expression:"clausesForm.jsgzms"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.toLook}},[t._v("规则预览")]),e("el-button",{nativeOn:{click:function(e){t.showDialog=!1}}},[t._v("\n        取消\n      ")]),e("el-button",{attrs:{type:"primary",disabled:!t.isKnowledge},nativeOn:{click:function(e){return t.saveClauses.apply(null,arguments)}}},[t._v("提交")])],1)],1),e("el-dialog",{attrs:{visible:t.showLookDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showLookDialog=e}}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.jsgz,expression:"jsgz"}],staticStyle:{width:"100%","min-height":"300px"},attrs:{disabled:""},domProps:{value:t.jsgz},on:{input:function(e){e.target.composing||(t.jsgz=e.target.value)}}})])],1)}),m=[],p=(s("8dee"),s("3441"),s("1bc7"),s("fc02"),s("6407")),d=s("ec9f"),v=s("1806"),b=s("a349");function g(t){var e=y();return function(){var s,a=Object(u["a"])(t);if(e){var l=Object(u["a"])(this).constructor;s=Reflect.construct(a,arguments,l)}else s=a.apply(this,arguments);return Object(c["a"])(this,s)}}function y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var k=function(t){Object(n["a"])(s,t);var e=g(s);function s(){var t;return Object(o["a"])(this,s),t=e.apply(this,arguments),t.page=1,t.size=10,t.total=0,t.search="",t.clausesTable=[],t.showDialog=!1,t.clausesForm={},t.btnstatus=!1,t.clausesRules={jsgz:[{required:!0,message:"请输入计算规则",trigger:"blur"}]},t.showLookDialog=!1,t.allList=[],t.list=[],t.optionList=[],t.jsgz="",t.isShow=!1,t}return Object(i["a"])(s,[{key:"mounted",value:function(){this.initswitchCard()}},{key:"getRowClass",value:function(){return"font-weight:blod; color:black; border-bottom: 1px RGBA(199, 199, 199, 1) solid;"}},{key:"changeList",value:function(t){this.allList=t||[]}},{key:"beforeInitClauses",value:function(){this.page=1,this.initClauses()}},{key:"switchCard",value:function(){this.btnstatus=!this.btnstatus,!1===this.btnstatus?(this.page=1,this.initClauses()):(this.page=1,this.initEvaluation())}},{key:"initswitchCard",value:function(){!1===this.btnstatus?this.initClauses():this.initEvaluation()}},{key:"initClauses",value:function(){var t=this,e={tmxmmc:this.search,page:this.page,size:this.size};this.$api.listAllLbtmmxk(e).then((function(e){var s=e.data||{};t.clausesTable=s.content||[],t.total=s.totalElements||0})).catch((function(){}))}},{key:"initEvaluation",value:function(){var t=this,e={tmxmmc:this.search,page:this.page,size:this.size};this.$api.listAllLbpgData(e).then((function(e){var s=e.data||{};t.clausesTable=s.content||[],t.total=s.totalElements||0})).catch((function(){}))}},{key:"editClauses",value:function(t){this.jsgz=t.jsgz,!1===this.btnstatus&&""!==t.jsgz?this.allList=this.toArray(t.jsgz):this.allList=[{value:1,status:"1",chanceList:[]}],this.listAll(t),this.clausesForm={tmmxkey:t.tmmxkey,tmxmdm:t.tmxmdm,tmxmmc:t.tmxmmc,tmms:t.tmms,jsgzms:t.jsgzms,jlzt:"0",jsgz:this.toJson(this.allList)},this.$refs["comClausesForm"]&&this.$refs.comClausesForm.resetFields(),this.showDialog=!0}},{key:"listAll",value:function(t){var e=this,s={tmxmdm:t.tmxmdm};this.$api.listByTmxmdm(s).then((function(t){var s=t.data||{};e.optionList=s})).catch((function(){}))}},{key:"toLook",value:function(){console.info("转化前",JSON.stringify(this.allList)),this.jsgz=this.toJson(this.allList),console.info("转化后",this.toArray(this.jsgz)),this.jsgz=Object(d["a"])(this.jsgz),this.showLookDialog=!0}},{key:"toArray",value:function(t){var e="",s=[{value:0,status:"",chanceList:[{value:0,label:""}]}];if(s=[],[],-1===t.indexOf("bool")){l=t.split('"term"'),l.splice(0,1),o=[];var a=l[0].split('"');o.push({value:1,label:a[1]}),s.push({value:1,status:"1",chanceList:o})}else{var l=t.split('"bool"'),i=l[1].split("term");i[0].indexOf("should")>-1?e="1":i[0].indexOf("must")>-1&&(e="2");var o=[{value:0,label:""}];i.splice(0,1);var n=0;if(o=[],i.forEach((function(t){var e=t.split('"');o.push({value:n+1,label:e[2]}),n+=1})),s.push({value:1,status:e,chanceList:o}),l.length>2)for(var c=0;c<l.length;c++)if(c>=2&&l[c].indexOf('"term"')>-1){var u=this.toArray('"bool"'+l[c]);s[0].chanceList.push({value:2,label:"",allList:u})}}var r=0;s[0].chanceList.length;s[0].chanceList.forEach((function(t){""===t.label&&(r+=1)}));var f=0;return s[0].chanceList.forEach((function(t){""===t.label?t.value=f+1:(t.value=r+1,r+=1)})),s[0].chanceList.sort(this.sortRule),s}},{key:"sortRule",value:function(t,e){return t.value-e.value}},{key:"toJson",value:function(t){var e=this,s='{\n"bool": {\n ',a=[""];a=[];var l="";"1"===this.allList[0].status?l='"should": [\n':"2"===this.allList[0].status&&(l='"must": [\n');var i=[{label:""}],o=[{allList:t}];return i=[],o=[],t[0].chanceList.forEach((function(t){t.label?i.push(t):t.allList&&o.push(t)})),i.forEach((function(t){t.label&&a.push('{\n"term":{\n"'+t.label+'":"true"\n}\n}')})),a.forEach((function(t){t===a[a.length-1]?l+=t:l=l+t+","})),a=[],o.forEach((function(t){if(t.allList.length>0){var s=e.toJson(t.allList);"1"===t.allList[0].status?s.indexOf("must")>-1&&(s=s.replace("must","should")):"2"===t.allList[0].status&&s.indexOf("should")>-1&&(s=s.replace("should","must")),a.push(s)}})),a.length>0&&(l+=","),a.forEach((function(t){t===a[a.length-1]?l+=t:l=l+t+","})),s=s+l+"\n]\n}\n}",s}},{key:"chooseClauses",value:function(t){this.$emit("update:clausesRow",t)}},{key:"saveClauses",value:function(){var t=this;this.$refs.comClausesForm.validate((function(e){e&&t.beforeCheck()&&!0===t.btnstatus?t.$api.saveJsgz(t.clausesForm).then((function(){t.$message.success("提交成功"),t.initClauses(),t.showDialog=!1})).catch((function(){})):e&&t.beforeCheck()&&!1===t.btnstatus&&(t.clausesForm.jsgz=t.toJson(t.allList),t.$api.saveLbtmmxk(t.clausesForm).then((function(){t.$message.success("提交成功"),t.initClauses(),t.showDialog=!1})).catch((function(){})))}))}},{key:"beforeCheck",value:function(){var t=this.clausesForm.jsgz||"",e=Object(d["a"])(t);return!!e&&(this.clausesForm.jsgz=e,!0)}}]),s}(f["c"]);Object(r["a"])([Object(f["b"])({required:!1})],k.prototype,"clausesRow",void 0),Object(r["a"])([b["a"]],k.prototype,"isKnowledge",void 0),k=Object(r["a"])([Object(f["a"])({name:"Clauses",components:{pagination:p["a"],tree:v["a"]}})],k);var w=k,L=w,j=(s("4047"),s("0b56")),x=Object(j["a"])(L,h,m,!1,null,null,null),C=x.exports,z=s("c7fd"),O=s("c1b0");function R(t){var e=F();return function(){var s,a=Object(u["a"])(t);if(e){var l=Object(u["a"])(this).constructor;s=Reflect.construct(a,arguments,l)}else s=a.apply(this,arguments);return Object(c["a"])(this,s)}}function F(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var D=function(t){Object(n["a"])(s,t);var e=R(s);function s(){var t;return Object(o["a"])(this,s),t=e.apply(this,arguments),t.clausesRow={},t.isLook=!1,t.isDisabled=!0,t.key=0,t}return Object(i["a"])(s)}(f["c"]);D=Object(r["a"])([Object(f["a"])({name:"VteClausesRules",components:{LeftClauses:C,RightNorm:z["a"],cellManagement:O["a"]}})],D);var _=D,E=_,$=(s("2aaa"),Object(j["a"])(E,a,l,!1,null,"6c37502a",null));e["default"]=$.exports},"2aaa":function(t,e,s){"use strict";s("31c3")},"31c3":function(t,e,s){},4047:function(t,e,s){"use strict";s("0959")}}]);