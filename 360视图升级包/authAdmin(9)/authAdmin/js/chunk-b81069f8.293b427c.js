(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b81069f8"],{"259f":function(t,e,a){"use strict";a("39a5")},"39a5":function(t,e,a){},c200:function(t,e,a){"use strict";a.r(e);a("a450");var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"my-template"},[e("h3",{staticClass:"my-title"},[t._v("模板列表：")]),e("div",{staticClass:"templates-container"},[e("el-table",{staticClass:"templates-table",staticStyle:{width:"100%"},attrs:{data:t.templates,stripe:"","highlight-current-row":"","row-style":t.tableRowStyle},on:{"row-click":t.handleCurrentTemplateChange}},[e("el-table-column",{attrs:{prop:"code",label:"编码",width:"100"}}),e("el-table-column",{attrs:{prop:"name",label:"名称",width:"170"}}),e("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180"}})],1),e("div",{staticClass:"template-operations"},[e("el-button",{attrs:{type:"primary"},on:{click:t.showImportTemplateDialog}},[t._v("\n        导入模板\n      ")]),e("el-button",{attrs:{type:"primary"},on:{click:t.showPropertyMappingDialog}},[t._v("\n        字段映射\n      ")])],1)],1),e("div",{staticClass:"properties-container"},[e("h3",{staticClass:"my-title"},[t._v("模板内属性列表：")]),e("el-table",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{data:t.properties,height:"100%",stripe:""}},[e("el-table-column",{attrs:{prop:"code",label:"编码","min-width":"80"}}),e("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"160"}}),e("el-table-column",{attrs:{prop:"createTime",label:"创建时间","min-width":"160"}})],1)],1),e("div",{staticClass:"template-preview-container"},[e("h3",{staticClass:"my-title"},[t._v("模板预览：")]),e("div",{staticClass:"template-preview",domProps:{innerHTML:t._s(t.currentTemplateContent)}})]),e("el-dialog",{attrs:{title:"导入模板",visible:t.importTemplateDialogVisible,"close-on-click-modal":!1,width:"620px"},on:{"update:visible":function(e){t.importTemplateDialogVisible=e}}},[e("el-form",{ref:"importTemplateForm",attrs:{model:t.importTemplate,rules:t.rules}},[e("el-form-item",{attrs:{label:"模板编码","label-width":"80px",prop:"code"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.importTemplate.code,callback:function(e){t.$set(t.importTemplate,"code",e)},expression:"importTemplate.code"}})],1),e("el-form-item",{attrs:{label:"模板名称","label-width":"80px",prop:"name"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.importTemplate.name,callback:function(e){t.$set(t.importTemplate,"name",e)},expression:"importTemplate.name"}})],1),e("el-form-item",{attrs:{label:"模板文件","label-width":"80px"}},[e("el-upload",{ref:"upload",attrs:{action:"http://127.0.0.1","auto-upload":!1,"http-request":t.uploadTemplate,accept:".html"}},[e("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("\n            选取文件\n          ")])],1)],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{nativeOn:{click:function(e){return t.closeDialog.apply(null,arguments)}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.submitUpload.apply(null,arguments)}}},[t._v("提交")])],1)],1),e("el-dialog",{attrs:{title:"字段映射",visible:t.propertyMappingDialogVisible,"close-on-click-modal":!1,width:"720px"},on:{"update:visible":function(e){t.propertyMappingDialogVisible=e}}},[e("el-form",{ref:"propertyMappingForm"},[e("el-table",{staticStyle:{width:"100%","max-height":"300px",overflow:"auto"},attrs:{data:t.mappings,stripe:""}},[e("el-table-column",{attrs:{prop:"propertyCode",label:"属性编码","min-width":"80"}}),e("el-table-column",{attrs:{prop:"propertyName",label:"属性名称","min-width":"160"}}),e("el-table-column",{attrs:{label:"检查指标项目代码","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-form-item",{staticClass:"inner-form-item"},[e("el-input",{model:{value:a.row.mappingCode,callback:function(e){t.$set(a.row,"mappingCode",e)},expression:"scope.row.mappingCode"}})],1)]}}])})],1),e("div",{staticStyle:{"margin-top":"20px","text-align":"right"}},[e("el-button",{nativeOn:{click:function(e){return t.closeDialog.apply(null,arguments)}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.submitPropertyMappingForm.apply(null,arguments)}}},[t._v("\n          确定\n        ")])],1)],1)],1)],1)},l=[],r=(a("7afe"),a("f13c")),o=a("ae5e"),p=a("acac"),n=a("2ad3"),s=a("e0e5"),c=a("fd63"),m=a("e4a1");function u(t){var e=d();return function(){var a,i=Object(s["a"])(t);if(e){var l=Object(s["a"])(this).constructor;a=Reflect.construct(i,arguments,l)}else a=i.apply(this,arguments);return Object(n["a"])(this,a)}}function d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var f=function(t){Object(p["a"])(a,t);var e=u(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.templates=[],t.properties=[],t.mappings=[],t.currentTemplateContent="",t.importTemplateDialogVisible=!1,t.propertyMappingDialogVisible=!1,t.uploadVisible=!1,t.importTemplate={code:"",name:"",createTime:"",file:""},t.rules={code:[{required:!0,message:"请输入模板编码",trigger:"blur"}],name:[{required:!0,message:"请输入模板名称",trigger:"blur"}]},t}return Object(o["a"])(a,[{key:"mounted",value:function(){this.getAllTemplates()}},{key:"tableRowStyle",value:function(){return"cursor:pointer;"}},{key:"getAllTemplates",value:function(){var t=this;this.$api.getAllTemplates().then((function(e){e.data&&e.data.length&&(t.templates=e.data||[],t.handleCurrentTemplateChange(e.data[0]||[]))})).catch((function(t){}))}},{key:"showImportTemplateDialog",value:function(){var t=this;this.importTemplateDialogVisible=!0,this.importTemplate={code:"",name:"",createTime:"",file:""},this.$nextTick((function(){t.$refs.upload.clearFiles()}))}},{key:"showPropertyMappingDialog",value:function(){this.propertyMappingDialogVisible=!0}},{key:"uploadTemplate",value:function(t){var e=this;this.$refs.importTemplateForm.validate((function(a){if(!a)return!1;var i=new FormData;i.append("code",e.importTemplate.code),i.append("name",e.importTemplate.name),i.append("file",t.file),e.$api.uploadTemplate(i).then((function(t){e.importTemplateDialogVisible=!1,t.status&&200===t.status?(e.$message.success("导入成功!"),e.getAllTemplates()):e.$message.error("导入失败！!")})).catch((function(t){}))}))}},{key:"submitUpload",value:function(){this.$refs.upload.submit()}},{key:"handleCurrentTemplateChange",value:function(t){this.getPropertiesByTemplateId(t.id),this.getPropertyMappingsByTemplateId(t.id),this.currentTemplateContent=t.content}},{key:"getPropertiesByTemplateId",value:function(t){var e=this;this.$api.getPropertiesByTemplateId({templateId:t}).then((function(t){t.data&&t.data.length&&(e.properties=t.data)})).catch((function(t){e.properties=[]}))}},{key:"getPropertyMappingsByTemplateId",value:function(t){var e=this;this.$api.getPropertyMappingsByTemplateId({templateId:t}).then((function(t){t.data&&t.data.length&&(e.mappings=t.data)})).catch((function(t){e.mappings=[]}))}},{key:"closeDialog",value:function(){this.propertyMappingDialogVisible=!1,this.importTemplateDialogVisible=!1}},{key:"submitPropertyMappingForm",value:function(t){var e=this,a=!0;this.mappings.every((function(t,e,i){null!=t.mappingCode&&""!==t.mappingCode||(a=!1)})),a?this.$api.savePropertyMappings({propertyMappings:JSON.stringify(this.mappings)}).then((function(t){e.propertyMappingDialogVisible=!1,t.status&&200===t.status?e.$message.success("保存成功!"):e.$message.error("保存失败!")})).catch((function(t){})):this.$notify.error({title:"提示",message:"检查指标项目代码不能有空值！"})}}]),a}(m["c"]);f=Object(c["a"])([Object(m["a"])({name:"MyTemplate"})],f);var g=f,h=g,b=(a("259f"),a("0b56")),y=Object(b["a"])(h,i,l,!1,null,"52ff2676",null);e["default"]=y.exports}}]);