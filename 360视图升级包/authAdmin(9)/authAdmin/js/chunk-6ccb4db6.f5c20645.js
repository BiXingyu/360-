(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ccb4db6"],{"17e0":function(e,t,a){"use strict";a("265b")},"265b":function(e,t,a){},"4f44":function(e,t,a){"use strict";a.r(t);a("a450");var o=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"role flex flex-v"},[t("div",{staticClass:"search flex flex-pack-justify-between flex-align-center"},[t("span",[t("el-input",{staticClass:"keyword",attrs:{placeholder:"请输入名称",clearable:!0},on:{clear:e.listRole},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.listRole.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("el-button",{staticClass:"query-btn",attrs:{type:"primary"},on:{click:e.listRole}},[e._v("\n        查询\n      ")])],1),t("el-button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:e.handleAddBtnClick}},[e._v("\n      新增\n    ")])],1),t("div",{staticClass:"content-main flex-1 mt-10"},[t("el-table",{staticClass:"custom-table",attrs:{data:e.roleList,"highlight-current-row":"","header-row-class-name":"table-header"}},[t("el-table-column",{attrs:{type:"index","min-width":"80"}}),t("el-table-column",{attrs:{prop:"name",label:"角色","min-width":"120"}}),t("el-table-column",{attrs:{prop:"roleTypeName",label:"类型","min-width":"120"}}),t("el-table-column",{attrs:{prop:"status",label:"启用",formatter:e.formatStatus,"min-width":"120",align:"center"}}),e.showHiddenMedicalRecordKeywords?t("el-table-column",{attrs:{prop:"hiddenMedicalRecordKeywords",label:"隐藏病历","min-width":"120",align:"center"}}):e._e(),t("el-table-column",{attrs:{prop:"note",label:"备注","min-width":"240",align:"left"}}),t("el-table-column",{attrs:{label:"操作","min-width":"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditBtnClick(a.row)}}},[e._v("\n            编辑\n          ")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleProtectBtnClick(a.row)}}},[e._v("\n            隐私保护\n          ")])]}}])})],1),t("pagination",{staticClass:"page-select",attrs:{page:e.page,size:e.size,total:e.total},on:{"update:page":function(t){e.page=t},"update:size":function(t){e.size=t},getTableData:e.listRoles}}),t("el-dialog",{attrs:{title:"add"===this.operationType?"新增角色":"编辑角色",visible:e.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t}}},[t("el-form",{ref:"roleForm",attrs:{model:e.roleForm,"label-width":"110px",rules:e.roleFormRules}},[t("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[t("el-input",{attrs:{maxlength:50},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),t("el-form-item",{attrs:{label:"角色类型",prop:"roleTypeCode"}},[t("el-select",{staticClass:"size-full",attrs:{placeholder:"请选择"},model:{value:e.roleForm.roleTypeCode,callback:function(t){e.$set(e.roleForm,"roleTypeCode",t)},expression:"roleForm.roleTypeCode"}},e._l(e.roleTypeList,(function(e){return t("el-option",{key:e.typeCode,attrs:{label:e.typeName,value:e.typeCode}})})),1)],1),t("el-form-item",{attrs:{label:"启用"}},[t("el-switch",{attrs:{"on-text":"是","off-text":"否"},model:{value:e.roleForm.status,callback:function(t){e.$set(e.roleForm,"status",t)},expression:"roleForm.status"}})],1),e.showHiddenMedicalRecordKeywords?t("el-form-item",{attrs:{label:"隐藏病历"}},[t("el-input",{model:{value:e.roleForm.hiddenMedicalRecordKeywords,callback:function(t){e.$set(e.roleForm,"hiddenMedicalRecordKeywords",t)},expression:"roleForm.hiddenMedicalRecordKeywords"}})],1):e._e(),t("el-form-item",{attrs:{label:"说明"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.roleForm.note,callback:function(t){e.$set(e.roleForm,"note",t)},expression:"roleForm.note"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.closeDialog.apply(null,arguments)}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitRoleForm.apply(null,arguments)}}},[e._v("\n          提交\n        ")])],1)],1),t("el-dialog",{attrs:{visible:e.showInfoProtectDialog,"close-on-click-modal":!1,width:"60%"},on:{"update:visible":function(t){e.showInfoProtectDialog=t}}},[t("el-tabs",{on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"患者隐私设置",name:"1"}}),t("el-tab-pane",{attrs:{label:"检验项目设置",name:"5"}}),t("el-tab-pane",{attrs:{label:"报告展示配置",name:"7"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.activeTab,expression:"activeTab === '1'"}]},[t("el-table",{attrs:{data:e.sensWordList,"highlight-current-row":""}},[t("el-table-column",{attrs:{prop:"sensWordName",label:"名称","min-width":"300"}}),t("el-table-column",{attrs:{prop:"sensWordRule",label:"规则","min-width":"200",formatter:e.formatSensWordRule}}),t("el-table-column",{attrs:{prop:"enable",label:"启用","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"on-text":"ON","off-text":"OFF"},model:{value:a.row.enable,callback:function(t){e.$set(a.row,"enable",t)},expression:"scope.row.enable"}})]}}])})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"5"===e.activeTab,expression:"activeTab === '5'"}]},[t("el-col",{attrs:{span:24}},[t("el-input",{staticClass:"w-200",attrs:{placeholder:"名称",clearable:"","auto-complete":"off"},on:{clear:function(t){return e.beforeSearch()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.beforeSearch()}},model:{value:e.subSensKeyword,callback:function(t){e.subSensKeyword=t},expression:"subSensKeyword"}}),t("el-button",{staticClass:"query-btn",attrs:{type:"primary"},on:{click:function(t){return e.beforeSearch()}}},[e._v("\n            查询\n          ")])],1),t("el-table",{ref:"table",attrs:{data:e.subSensList,"highlight-current-row":""}},[t("el-table-column",{attrs:{prop:"bblx",label:"标本","min-width":"73"}}),t("el-table-column",{attrs:{prop:"bglbmc",label:"报告类别","min-width":"100"}}),t("el-table-column",{attrs:{prop:"code",label:"项目代码","min-width":"120"}}),t("el-table-column",{attrs:{prop:"name",label:"项目名称","min-width":"185"}}),t("el-table-column",{attrs:{prop:"enable",label:"启用","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{size:"mini","on-text":"ON","off-text":"OFF"},model:{value:a.row.enable,callback:function(t){e.$set(a.row,"enable",t)},expression:"scope.row.enable"}})]}}])})],1),t("pagination",{attrs:{page:e.tabPage,size:e.tabSize,total:e.tabTotal},on:{"update:page":function(t){e.tabPage=t},"update:size":function(t){e.tabSize=t},getTableData:e.getPagedRoleSubSenses}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"7"===e.activeTab,expression:"activeTab === '7'"}]},[t("el-col",{attrs:{span:24}},[t("el-input",{staticClass:"w-200",attrs:{placeholder:"名称",clearable:"","auto-complete":"off"},on:{clear:function(t){return e.beforeSearch()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.beforeSearch()}},model:{value:e.reportShowKeyword,callback:function(t){e.reportShowKeyword=t},expression:"reportShowKeyword"}}),t("el-button",{staticClass:"query-btn",attrs:{type:"primary"},on:{click:function(t){return e.beforeSearch()}}},[e._v("\n            查询\n          ")])],1),t("el-table",{ref:"table",attrs:{data:e.reportShowList,"highlight-current-row":""}},[t("el-table-column",{attrs:{prop:"code",label:"报告代码"}}),t("el-table-column",{attrs:{prop:"name",label:"报告名称"}}),t("el-table-column",{attrs:{prop:"enable",label:"优先展示原始报告"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{size:"mini","on-text":"ON","off-text":"OFF"},model:{value:a.row.enable,callback:function(t){e.$set(a.row,"enable",t)},expression:"scope.row.enable"}})]}}])})],1),t("pagination",{attrs:{page:e.reportShowTabPage,size:e.reportShowTabSize,total:e.reportShowTabTotal},on:{"update:page":function(t){e.reportShowTabPage=t},"update:size":function(t){e.reportShowTabSize=t},getTableData:e.getReportShowConfigList}})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){e.showInfoProtectDialog=!1}}},[e._v("\n          取消\n        ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.saveSensInfo.apply(null,arguments)}}},[e._v("提交")])],1)],1)],1)])},n=[],i=(a("7afe"),a("1bc7"),a("f13c")),l=a("ae5e"),s=a("acac"),r=a("2ad3"),c=a("e0e5"),u=a("fd63"),d=a("e4a1"),p=a("6407");function h(e){var t=f();return function(){var a,o=Object(c["a"])(e);if(t){var n=Object(c["a"])(this).constructor;a=Reflect.construct(o,arguments,n)}else a=o.apply(this,arguments);return Object(r["a"])(this,a)}}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var b=function(e){Object(s["a"])(a,e);var t=h(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.activeRoleId=0,e.activeTab="1",e.roleList=[],e.roleTypeList=[],e.ruleList=[{rule:"*",name:"隐藏所有"},{rule:"$*",name:"只显示第一位"},{rule:"$2*",name:"显示前俩位"},{rule:"*$2",name:"显示最后俩位"},{rule:"*$4",name:"显示最后四位"},{rule:"$1*$1",name:"显示前一位和后一位"},{rule:"$3*$3",name:"显示前三位和后三位"}],e.keyword="",e.subSensKeyword="",e.moduleList=[],e.sensWordList=[],e.subSensList=[],e.diagnosisKeyword="",e.diagnosisList=[],e.reportShowKeyword="",e.reportShowList=[],e.diagnosisEnableAll=!1,e.showDialog=!1,e.showInfoProtectDialog=!1,e.tabPage=1,e.tabSize=10,e.tabTotal=0,e.diagnosisTabPage=1,e.diagnosisTabSize=10,e.diagnosisTabTotal=0,e.reportShowTabPage=1,e.reportShowTabSize=10,e.reportShowTabTotal=0,e.operationType="add",e.page=1,e.size=10,e.total=0,e.showHiddenMedicalRecordKeywords=!1,e.roleForm={id:0,name:"",roleTypeCode:"",status:!0,note:"",hiddenMedicalRecordKeywords:""},e.roleFormRules={name:[{validator:e.validExistName,trigger:"blur"}],roleTypeCode:[{required:!0,message:"请选择角色类型",trigger:"change"}]},e}return Object(l["a"])(a,[{key:"mounted",value:function(){this.listAllRoleTypes(),this.listRoles(),this.initShowHiddenMedicalRecordKeywords()}},{key:"closeDialog",value:function(){this.showDialog=!1}},{key:"closeInfoProtectDialog",value:function(){this.showInfoProtectDialog=!1}},{key:"formatStatus",value:function(e,t){return e.status?"是":"否"}},{key:"formatSensWordRule",value:function(e,t){for(var a="",o=0;o<this.ruleList.length;o++)if(e.sensWordRule===this.ruleList[o].rule){a=this.ruleList[o].name;break}return a}},{key:"beforeSearch",value:function(){"5"===this.activeTab?(this.tabPage=1,this.getPagedRoleSubSenses()):"6"===this.activeTab?(this.diagnosisTabPage=1,this.getRoleDiagnoseList()):"7"===this.activeTab&&(this.reportShowTabPage=1,this.getReportShowConfigList())}},{key:"getRoleDiagnoseList",value:function(){var e=this,t={keyword:this.diagnosisKeyword,diagnosisAllEnableFlag:this.diagnosisEnableAll?1:0,page:this.diagnosisTabPage,size:this.diagnosisTabSize,roleId:this.activeRoleId};this.$api.getRoleDiagnoseList(t).then((function(t){var a=t.data||{};e.diagnosisList=a.content||[],e.diagnosisList.forEach((function(e){e.enable=1===e.enable})),e.diagnosisTabTotal=a.totalElements||0})).catch((function(e){}))}},{key:"getReportShowConfigList",value:function(){var e=this,t={keyword:this.reportShowKeyword,page:this.reportShowTabPage,size:this.reportShowTabSize,roleId:this.activeRoleId};this.$api.getReportShowConfigList(t).then((function(t){var a=t.data||{};e.reportShowList=a.content||[],e.reportShowList.forEach((function(e){e.enable=1===e.enable})),e.reportShowTabTotal=a.totalElements||0})).catch((function(e){}))}},{key:"getPagedRoleSubSenses",value:function(){var e=this,t={roleId:this.activeRoleId,keyword:this.subSensKeyword,type:5,page:this.tabPage,size:this.tabSize};this.$api.getPagedRoleSubSenses(t).then((function(t){var a=t.data||{};e.subSensList=a.content||[],e.tabTotal=a.totalElements||0})).catch((function(e){}))}},{key:"handleAddBtnClick",value:function(){var e=this;this.operationType="add",this.roleForm={id:0,name:"",roleTypeCode:"",status:!0,note:"",hiddenMedicalRecordKeywords:""},this.showDialog=!0,this.$nextTick((function(){e.$refs.roleForm.clearValidate()}))}},{key:"handleEditBtnClick",value:function(e){this.$router.push({name:"roleEdit",query:{roleId:e.id}})}},{key:"handleProtectBtnClick",value:function(e){this.activeRoleId=e.id,this.activeTab="1",this.listSensWords(),this.showInfoProtectDialog=!0}},{key:"handleTabClick",value:function(e){"5"===e.name?(this.tabPage=1,this.getPagedRoleSubSenses(),this.activeTab="5",this.listSensWords()):"1"===e.name?(this.activeTab="1",this.listSensWords()):"6"===e.name?(this.tabPage=1,this.getRoleDiagnoseList(),this.activeTab="6",this.listSensWords()):"7"===e.name&&(this.tabPage=1,this.getReportShowConfigList(),this.activeTab="7",this.listSensWords())}},{key:"listAllRoleTypes",value:function(){var e=this;this.$api.listAllRoleTypes().then((function(t){e.roleTypeList=t.data||[]})).catch((function(e){}))}},{key:"listModuleConfigsOfRole",value:function(e){var t=this;this.$api.listModuleConfigsOfRole({roleId:e}).then((function(e){t.moduleList=e.data||[]})).catch((function(e){}))}},{key:"listRole",value:function(){this.page=1,this.listRoles()}},{key:"listRoles",value:function(){var e=this;this.$api.listRoles({keyword:this.keyword,page:this.page,size:this.size}).then((function(t){var a=t.data||{};e.roleList=a.content||[],e.total=a.totalElements||0})).catch((function(e){}))}},{key:"listSensWords",value:function(){var e=this;this.$api.listSensWordDtosByRoleId({roleId:this.activeRoleId}).then((function(t){e.sensWordList=t.data||[]})).catch((function(e){}))}},{key:"saveSensInfo",value:function(){var e=this;if("1"===this.activeTab){var t=[];this.sensWordList.forEach((function(a){t.push({id:a.id,roleId:e.activeRoleId,sensId:a.sensWordId,enable:a.enable})})),this.$api.saveRoleSensWords({roleSensWordListJson:JSON.stringify(t)}).then((function(t){e.showInfoProtectDialog=!1,e.$message({message:"角色、隐私规则配置成功！",type:"success"})})).catch((function(e){}))}else if("5"===this.activeTab){var a=[];this.subSensList.forEach((function(t){a.push({id:t.id,roleId:e.activeRoleId,subCode:t.code,masterCode:t.bglbdm,type:5,bblx:t.bblx,enable:t.enable})})),this.$api.saveRoleSubSensList({roleId:this.activeRoleId,roleSubSensListJson:JSON.stringify(a)}).then((function(t){e.showInfoProtectDialog=!1,e.$message({message:"角色、检验项目配置成功！",type:"success"})})).catch((function(e){}))}}},{key:"submitRoleForm",value:function(e){var t=this;this.$refs.roleForm.validate((function(e){if(e){var a="add"===t.operationType?"添加成功！":"修改成功！";"add"===t.operationType?t.$api.addRole(t.roleForm).then((function(e){t.showDialog=!1,t.$message({message:a,type:"success"}),t.listRoles()})).catch((function(e){})):t.$api.updateRole(t.roleForm).then((function(e){t.showDialog=!1,t.$message({message:a,type:"success"}),t.listRoles()})).catch((function(e){}))}}))}},{key:"validExistName",value:function(e,t){var a=this;return new Promise((function(e,o){""===t&&o("角色名称不能为空！"),a.$api.existRole({name:a.roleForm.name,id:a.roleForm.id}).then((function(t){return!0===t.data?o("角色名称已存在！"):e()})).catch((function(e){}))}))}},{key:"initShowHiddenMedicalRecordKeywords",value:function(){var e=this;this.$api.getSystemConfig({keyCode:"hide_some_medical_record_switch"}).then((function(t){var a=!1;if(t.data){var o=t.data;a=o.enable&&"1"===o.keyValue}e.showHiddenMedicalRecordKeywords=a})).catch((function(e){}))}}]),a}(d["c"]);b=Object(u["a"])([Object(d["a"])({name:"Role",components:{pagination:p["a"]}})],b);var m=b,g=m,y=(a("17e0"),a("0b56")),v=Object(y["a"])(g,o,n,!1,null,"eefedb68",null);t["default"]=v.exports},6407:function(e,t,a){"use strict";var o=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total,"pager-count":e.pagerCount},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})},n=[],i=(a("7afe"),a("f13c")),l=a("ae5e"),s=a("acac"),r=a("2ad3"),c=a("e0e5"),u=a("fd63"),d=a("e4a1");function p(e){var t=h();return function(){var a,o=Object(c["a"])(e);if(t){var n=Object(c["a"])(this).constructor;a=Reflect.construct(o,arguments,n)}else a=o.apply(this,arguments);return Object(r["a"])(this,a)}}function h(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var f=function(e){Object(s["a"])(a,e);var t=p(a);function a(){return Object(i["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"currentPage",get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},{key:"pageSize",get:function(){return this.size},set:function(e){this.$emit("update:size",e)}},{key:"handleSizeChange",value:function(e){this.currentPage=1,this.$emit("getTableData")}},{key:"handleCurrentChange",value:function(e){this.$emit("getTableData")}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])({required:!0})],f.prototype,"total",void 0),Object(u["a"])([Object(d["b"])({default:1})],f.prototype,"page",void 0),Object(u["a"])([Object(d["b"])({default:10})],f.prototype,"size",void 0),Object(u["a"])([Object(d["b"])({default:7})],f.prototype,"pagerCount",void 0),Object(u["a"])([Object(d["b"])({default:function(){return[10,20,30,50]}})],f.prototype,"pageSizes",void 0),Object(u["a"])([Object(d["b"])({default:"total, sizes, prev, pager, next, jumper"})],f.prototype,"layout",void 0),f=Object(u["a"])([Object(d["a"])({name:"pagination"})],f);var b=f,m=b,g=(a("84c7"),a("0b56")),y=Object(g["a"])(m,o,n,!1,null,"7e267c7f",null);t["a"]=y.exports},"84c7":function(e,t,a){"use strict";a("f180")},f180:function(e,t,a){}}]);