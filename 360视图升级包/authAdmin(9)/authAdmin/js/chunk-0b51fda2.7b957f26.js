(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b51fda2"],{"0d79":function(e,t,r){"use strict";r.r(t);r("aa18"),r("982e"),r("a450");var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"external-resources flex flex-v"},[t("div",{staticClass:"search-condition flex flex-pack-justify-between"},[t("div",{staticClass:"condition flex"},[t("el-input",{staticClass:"w-200",attrs:{placeholder:"请输入资源名称",clearable:""},on:{clear:e.queryData},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryData.apply(null,arguments)}},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}}),t("el-button",{staticClass:"ml-20",attrs:{type:"primary"},on:{click:e.queryData}},[e._v("\n        查询\n      ")])],1),t("el-button",{attrs:{type:"primary"},on:{click:e.addResources}},[e._v("\n      新增\n    ")])],1),t("div",{staticClass:"table-container flex-1 mt-10"},[t("el-table",{staticStyle:{width:"99%"},attrs:{data:e.tableData,stripe:""}},[t("el-table-column",{attrs:{type:"index",label:"#","min-width":"5%"}}),t("el-table-column",{attrs:{prop:"resourceCode",label:"编码","min-width":"8%",sortable:""}}),t("el-table-column",{attrs:{prop:"resourceName",label:"资源名称","min-width":"10%",sortable:""}}),t("el-table-column",{attrs:{prop:"externalLink",label:"链接","min-width":"30%"}}),t("el-table-column",{attrs:{prop:"browser",label:"浏览器","min-width":"8%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s("ie"===t.row.browser?"IE":"firefox"===t.row.browser?"火狐":"chrome"===t.row.browser?"谷歌":"")+"\n        ")]}}])}),t("el-table-column",{attrs:{prop:"institutionName",label:"机构名称","min-width":"10%",sortable:""}}),t("el-table-column",{attrs:{prop:"enable",label:"启用","min-width":"5%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(0===t.row.enable?"否":"是")+"\n        ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"350"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editResource(r.row)}}},[e._v("\n            编辑\n          ")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.cloneResources(r.row)}}},[e._v("\n            克隆\n          ")]),t("el-button",{attrs:{type:r.row.enable?"danger":"primary"},on:{click:function(t){return e.taggleEnable(r.row)}}},[e._v("\n            "+e._s(r.row.enable?"停用":"启用")+"\n          ")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deteleResource(r.row)}}},[e._v("\n            删除\n          ")])]}}])})],1),t("pagination",{attrs:{total:e.total,page:e.page,size:e.size},on:{"update:page":function(t){e.page=t},"update:size":function(t){e.size=t},getTableData:e.getTableData}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.resourceObj,"label-width":"80px",rules:e.formRules}},[t("el-form-item",{attrs:{label:"资源分类",prop:"resourceType"}},[t("el-select",{attrs:{disabled:1===e.handerType},on:{change:e.resourceTypeChange},model:{value:e.resourceObj.resourceType,callback:function(t){e.$set(e.resourceObj,"resourceType",t)},expression:"resourceObj.resourceType"}},e._l(e.resourcesType,(function(e){return t("el-option",{key:e.type,attrs:{label:e.name,value:e.type}})})),1)],1),t("el-form-item",{attrs:{label:"资源名称",prop:"resourceName"}},[["RIS","LIS"].includes(e.resourceObj.resourceType)?t("el-select",{ref:"nameSelect",attrs:{filterable:"",multiple:"",disabled:1===e.handerType},on:{change:e.resourceNameChange,"remove-tag":e.resourceNameChange},model:{value:e.multipleResourceName,callback:function(t){e.multipleResourceName=t},expression:"multipleResourceName"}},e._l(e.resourceNameArr,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1):t("el-input",{attrs:{maxlength:50,disabled:1===e.handerType},model:{value:e.resourceObj.resourceName,callback:function(t){e.$set(e.resourceObj,"resourceName",t)},expression:"resourceObj.resourceName"}})],1),0===e.handerType?t("el-form-item",{attrs:{label:"资源编码",prop:"resourceCode"}},[t("el-input",{attrs:{maxlength:50,disabled:["RIS","LIS"].includes(e.resourceObj.resourceType)},model:{value:e.resourceObj.resourceCode,callback:function(t){e.$set(e.resourceObj,"resourceCode",t)},expression:"resourceObj.resourceCode"}})],1):e._e(),t("el-form-item",{attrs:{label:"外部链接",prop:"externalLink"}},[t("el-input",{attrs:{maxlength:500},model:{value:e.resourceObj.externalLink,callback:function(t){e.$set(e.resourceObj,"externalLink",t)},expression:"resourceObj.externalLink"}})],1),t("el-form-item",{attrs:{label:"浏览器",prop:"browser"}},[t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.resourceObj.browser,callback:function(t){e.$set(e.resourceObj,"browser",t)},expression:"resourceObj.browser"}},e._l(e.browserType,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1),t("el-form-item",{attrs:{label:"机构名称",prop:"institutionCode"}},[t("el-select",{attrs:{filterable:"",placeholder:"请输入机构名称"},model:{value:e.resourceObj.institutionCode,callback:function(t){e.$set(e.resourceObj,"institutionCode",t)},expression:"resourceObj.institutionCode"}},e._l(e.institution,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.code}})})),1)],1),t("el-form-item",{attrs:{label:"打开方式",prop:"openWay"}},[t("el-select",{model:{value:e.resourceObj.openWay,callback:function(t){e.$set(e.resourceObj,"openWay",t)},expression:"resourceObj.openWay"}},e._l(e.openWayList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"是否启用",prop:"enable"}},[t("el-switch",{attrs:{"on-text":"ON","off-text":"OFF","active-value":1,"inactive-value":0},model:{value:e.resourceObj.enable,callback:function(t){e.$set(e.resourceObj,"enable",t)},expression:"resourceObj.enable"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.dialogSure}},[e._v("确 定")])],1)],1)],1)},o=[],n=(r("7afe"),r("f13c")),i=r("ae5e"),s=r("acac"),c=r("2ad3"),u=r("e0e5"),l=r("fd63"),p=r("e4a1"),b=r("6407");function d(e){var t=f();return function(){var r,a=Object(u["a"])(e);if(t){var o=Object(u["a"])(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return Object(c["a"])(this,r)}}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var h=function(e){Object(s["a"])(r,e);var t=d(r);function r(){var e;return Object(n["a"])(this,r),e=t.apply(this,arguments),e.searchStr="",e.tableData=[],e.dialogTitle="",e.dialogVisible=!1,e.handerType=0,e.openWayList=[{value:"0",label:"内嵌打开"},{value:"1",label:"弹出打开"}],e.resourceObj={resourceType:"",resourceName:"",resourceCode:"",externalLink:"",browser:"",institutionCode:"",enable:1,openWay:""},e.browserType=[{code:"ie",name:"IE浏览器"},{code:"firefox",name:"火狐浏览器"},{code:"chrome",name:"谷歌浏览器"}],e.formRules={resourceType:[{required:!0,message:"请选择资源类型",trigger:"change"}],resourceName:[{required:!0,message:"请选择资源名称",trigger:"change"},{required:!0,message:"请输入资源名称",trigger:"blur"}],resourceCode:[{required:!0,message:"请输入资源编码",trigger:"blur"}],externalLink:[{required:!0,message:"请输入外部链接",trigger:"blur"}],institutionCode:[{required:!0,message:"请选择机构",trigger:"change"}],openWay:[{required:!0,message:"请选择链接打开方式",trigger:"change"}]},e.institution=[],e.resourcesType=[],e.orginalResourceNameArr=[],e.total=0,e.page=1,e.size=10,e.multipleResourceName=[],e}return Object(i["a"])(r,[{key:"resourceNameArr",get:function(){var e=-1;"LIS"===this.resourceObj.resourceType&&(e=5),"RIS"===this.resourceObj.resourceType&&(e=4);var t=[];return-1!==e&&(t=this.orginalResourceNameArr.filter((function(t){return t.type===e}))),t||[]}},{key:"mounted",value:function(){this.getTableData(),this.getResourcesTypeList(),this.getInstitutionsList()}},{key:"queryData",value:function(){this.page=1,this.getTableData()}},{key:"getResourcesTypeList",value:function(){var e=this;this.$api.getResourceByCodeLike().then((function(t){e.resourcesType=t.data||[]})).catch((function(t){e.$message.error("获取机构类型失败！")}))}},{key:"getInstitutionsList",value:function(){var e=this;this.$api.listInstitutions({keyword:""}).then((function(t){e.institution=t.data||[]})).catch((function(t){e.$message.error("获取机构列表失败！")}))}},{key:"getTableData",value:function(){var e=this,t={name:this.searchStr,page:this.page,size:this.size};this.$api.getResourceConfigByNameLike(t).then((function(t){var r=t.data||{};e.tableData=r.content||[],e.total=r.totalElements||0})).catch((function(e){}))}},{key:"addResources",value:function(){var e=this;this.getAllResourcesName(),this.handerType=0,this.dialogTitle="新增资源",this.multipleResourceName=[],this.resourceObj={resourceType:"",resourceName:"",resourceCode:"",externalLink:"",browser:"",institutionCode:"",enable:1,openWay:"0"},this.dialogVisible=!0,this.$nextTick((function(){e.$refs.form.clearValidate()}))}},{key:"cloneResources",value:function(e){var t=this;this.getAllResourcesName(),this.handerType=0,this.dialogTitle="克隆资源",this.multipleResourceName=[],this.resourceObj={resourceType:"",resourceName:"",resourceCode:"",externalLink:e.externalLink,browser:e.browser,institutionCode:e.institutionCode,enable:1,openWay:e.openWay},this.dialogVisible=!0,this.$nextTick((function(){t.$refs.form.clearValidate()}))}},{key:"editResource",value:function(e){var t=this;this.handerType=1,this.dialogTitle="编辑资源",this.multipleResourceName=[e.resourceName],this.resourceObj={id:e.id,resourceType:e.resourceType,resourceName:e.resourceName,resourceCode:e.resourceCode,externalLink:e.externalLink,browser:e.browser,institutionCode:e.institutionCode,enable:e.enable,openWay:e.openWay},this.dialogVisible=!0,this.$nextTick((function(){t.$refs.form.clearValidate()}))}},{key:"resourceTypeChange",value:function(){var e=this;this.$nextTick((function(){e.multipleResourceName=[],e.resourceObj.resourceName="",e.resourceObj.resourceCode="",e.$refs.form.clearValidate(),0===e.handerType&&["RIS","LIS"].includes(e.resourceObj.resourceType)&&e.$refs.nameSelect.focus()}))}},{key:"dialogSure",value:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;var r={externalLink:e.resourceObj.externalLink,institutionCode:e.resourceObj.institutionCode,browser:e.resourceObj.browser,enable:e.resourceObj.enable,openWay:e.resourceObj.openWay};e.handerType?r.id=e.resourceObj.id:(r.resourceType=e.resourceObj.resourceType,["RIS","LIS"].includes(e.resourceObj.resourceType)?r.resourceCodeArr=e.multipleResourceName.join(","):(r.resourceName=e.resourceObj.resourceName,r.resourceCodeArr=e.resourceObj.resourceCode)),e.handerType?e.handlerEditResource(r):e.handlerAddResource(r)}))}},{key:"taggleEnable",value:function(e){var t=this;this.$confirm("".concat(e.enable?"停用":"启用","该资源？"),"提示",{type:"warning"}).then((function(){var r={id:e.id,externalLink:e.externalLink,institutionCode:e.institutionCode,browser:e.browser,enable:1===e.enable?0:1,openWay:e.openWay};t.handlerEditResource(r)})).catch((function(e){}))}},{key:"handlerAddResource",value:function(e){var t=this;this.$api.addResourceConfig(e).then((function(e){t.$message.success("保存成功！"),t.dialogVisible=!1,t.getTableData()})).catch((function(e){t.dialogVisible=!1}))}},{key:"handlerEditResource",value:function(e){var t=this;this.$api.editResourceConfig(e).then((function(e){t.$message.success("修改成功！"),t.dialogVisible=!1,t.getTableData()})).catch((function(e){t.dialogVisible=!1}))}},{key:"handlerDeleteResource",value:function(e){var t=this;this.$api.deleteResourceConfig({id:e}).then((function(e){t.$message.success("删除成功！"),1===t.tableData.length&&t.page>1&&(t.page=t.page-1),t.getTableData()})).catch((function(e){}))}},{key:"deteleResource",value:function(e){var t=this;this.$confirm("确定删除该资源？","提示",{type:"warning"}).then((function(){t.handlerDeleteResource(e.id)})).catch((function(e){}))}},{key:"getAllResourcesName",value:function(){var e=this;this.$api.getMasterItemByType().then((function(t){e.orginalResourceNameArr=t.data||[]})).catch((function(t){e.$message.error("获取未配置资源名称列表失败！")}))}},{key:"resourceNameChange",value:function(e){this.resourceObj.resourceCode=e.join(","),""===this.resourceObj.resourceName&&(this.resourceObj.resourceName="1")}}]),r}(p["c"]);h=Object(l["a"])([Object(p["a"])({name:"ExternalResources",components:{pagination:b["a"]}})],h);var m=h,g=m,y=(r("77ca"),r("0b56")),v=Object(y["a"])(g,a,o,!1,null,"12250506",null);t["default"]=v.exports},"4b95":function(e,t,r){},6407:function(e,t,r){"use strict";var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total,"pager-count":e.pagerCount},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})},o=[],n=(r("7afe"),r("f13c")),i=r("ae5e"),s=r("acac"),c=r("2ad3"),u=r("e0e5"),l=r("fd63"),p=r("e4a1");function b(e){var t=d();return function(){var r,a=Object(u["a"])(e);if(t){var o=Object(u["a"])(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return Object(c["a"])(this,r)}}function d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var f=function(e){Object(s["a"])(r,e);var t=b(r);function r(){return Object(n["a"])(this,r),t.apply(this,arguments)}return Object(i["a"])(r,[{key:"currentPage",get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},{key:"pageSize",get:function(){return this.size},set:function(e){this.$emit("update:size",e)}},{key:"handleSizeChange",value:function(e){this.currentPage=1,this.$emit("getTableData")}},{key:"handleCurrentChange",value:function(e){this.$emit("getTableData")}}]),r}(p["c"]);Object(l["a"])([Object(p["b"])({required:!0})],f.prototype,"total",void 0),Object(l["a"])([Object(p["b"])({default:1})],f.prototype,"page",void 0),Object(l["a"])([Object(p["b"])({default:10})],f.prototype,"size",void 0),Object(l["a"])([Object(p["b"])({default:7})],f.prototype,"pagerCount",void 0),Object(l["a"])([Object(p["b"])({default:function(){return[10,20,30,50]}})],f.prototype,"pageSizes",void 0),Object(l["a"])([Object(p["b"])({default:"total, sizes, prev, pager, next, jumper"})],f.prototype,"layout",void 0),f=Object(l["a"])([Object(p["a"])({name:"pagination"})],f);var h=f,m=h,g=(r("84c7"),r("0b56")),y=Object(g["a"])(m,a,o,!1,null,"7e267c7f",null);t["a"]=y.exports},"77ca":function(e,t,r){"use strict";r("4b95")},"84c7":function(e,t,r){"use strict";r("f180")},f180:function(e,t,r){}}]);