(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57eb71b3"],{2646:function(t,e,o){},"2da9":function(t,e,o){(function(o){var r,n;(function(e,o){t.exports=o(e)})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof o?o:this,(function(o){"use strict";o=o||{};var i,s=o.Base64,a="2.6.4",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=function(t){for(var e={},o=0,r=t.length;o<r;o++)e[t.charAt(o)]=o;return e}(c),u=String.fromCharCode,d=function(t){if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?u(192|e>>>6)+u(128|63&e):u(224|e>>>12&15)+u(128|e>>>6&63)+u(128|63&e)}e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return u(240|e>>>18&7)+u(128|e>>>12&63)+u(128|e>>>6&63)+u(128|63&e)},f=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,h=function(t){return t.replace(f,d)},p=function(t){var e=[0,2,1][t.length%3],o=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),r=[c.charAt(o>>>18),c.charAt(o>>>12&63),e>=2?"=":c.charAt(o>>>6&63),e>=1?"=":c.charAt(63&o)];return r.join("")},g=o.btoa&&"function"==typeof o.btoa?function(t){return o.btoa(t)}:function(t){if(t.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return t.replace(/[\s\S]{1,3}/g,p)},m=function(t){return g(h(String(t)))},v=function(t){return t.replace(/[+\/]/g,(function(t){return"+"==t?"-":"_"})).replace(/=/g,"")},S=function(t,e){return e?v(m(t)):m(t)},y=function(t){return S(t,!0)};o.Uint8Array&&(i=function(t,e){for(var o="",r=0,n=t.length;r<n;r+=3){var i=t[r],s=t[r+1],a=t[r+2],l=i<<16|s<<8|a;o+=c.charAt(l>>>18)+c.charAt(l>>>12&63)+("undefined"!=typeof s?c.charAt(l>>>6&63):"=")+("undefined"!=typeof a?c.charAt(63&l):"=")}return e?v(o):o});var b,I=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,A=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),o=e-65536;return u(55296+(o>>>10))+u(56320+(1023&o));case 3:return u((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return u((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},F=function(t){return t.replace(I,A)},_=function(t){var e=t.length,o=e%4,r=(e>0?l[t.charAt(0)]<<18:0)|(e>1?l[t.charAt(1)]<<12:0)|(e>2?l[t.charAt(2)]<<6:0)|(e>3?l[t.charAt(3)]:0),n=[u(r>>>16),u(r>>>8&255),u(255&r)];return n.length-=[0,0,2,1][o],n.join("")},E=o.atob&&"function"==typeof o.atob?function(t){return o.atob(t)}:function(t){return t.replace(/\S{1,4}/g,_)},x=function(t){return E(String(t).replace(/[^A-Za-z0-9\+\/]/g,""))},C=function(t){return F(E(t))},w=function(t){return String(t).replace(/[-_]/g,(function(t){return"-"==t?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},T=function(t){return C(w(t))};o.Uint8Array&&(b=function(t){return Uint8Array.from(x(w(t)),(function(t){return t.charCodeAt(0)}))});var O=function(){var t=o.Base64;return o.Base64=s,t};if(o.Base64={VERSION:a,atob:x,btoa:g,fromBase64:T,toBase64:S,utob:h,encode:S,encodeURI:y,btou:F,decode:T,noConflict:O,fromUint8Array:i,toUint8Array:b},"function"===typeof Object.defineProperty){var L=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};o.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",L((function(){return T(this)}))),Object.defineProperty(String.prototype,"toBase64",L((function(t){return S(this,t)}))),Object.defineProperty(String.prototype,"toBase64URI",L((function(){return S(this,!0)})))}}return o["Meteor"]&&(Base64=o.Base64),t.exports?t.exports.Base64=o.Base64:(r=[],n=function(){return o.Base64}.apply(e,r),void 0===n||(t.exports=n)),{Base64:o.Base64}}))}).call(this,o("2409"))},"3a89":function(t,e,o){"use strict";o.r(e);o("a450");var r=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"login-container"},[e("div",{staticClass:"login"},[e("div",{staticClass:"left"}),e("div",{staticClass:"right flex flex-v"},[e("div",{staticClass:"icon-login"}),e("h3",{staticClass:"title"},[t._v("后台管理系统")]),e("el-form",{ref:"loginForm",class:["flex-1","flex","flex-v","flex-pack-justify-around",{"form-margin":t.productList.length<2&&t.hosptailList.length<2}],attrs:{model:t.loginForm,rules:t.formRules,"label-position":"left","label-width":"0"}},[e("el-form-item",{attrs:{prop:"account"}},[e("el-input",{staticClass:"user-input",attrs:{type:"text",size:"small","auto-complete":"off",placeholder:"请输入账号","prefix-icon":"el-icon-user"},on:{change:t.listAllProducts},model:{value:t.loginForm.account,callback:function(e){t.$set(t.loginForm,"account",e)},expression:"loginForm.account"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{staticClass:"form-input",attrs:{type:"password",size:"small","auto-complete":"off",placeholder:"请输入密码","prefix-icon":"el-icon-edit-outline"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.productList.length>1,expression:"productList.length > 1"}],attrs:{prop:"productId"}},[e("el-select",{staticClass:"form-select",attrs:{size:"small",placeholder:"请选择产品"},model:{value:t.loginForm.productId,callback:function(e){t.$set(t.loginForm,"productId",e)},expression:"loginForm.productId"}},t._l(t.productList,(function(t){return e("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})),1)],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.hosptailList.length>1,expression:"hosptailList.length > 1"}],attrs:{prop:"hosptailId"}},[e("el-select",{staticClass:"form-select",attrs:{size:"small",placeholder:"请选择院区"},model:{value:t.loginForm.hosptailId,callback:function(e){t.$set(t.loginForm,"hosptailId",e)},expression:"loginForm.hosptailId"}},t._l(t.hosptailList,(function(t){return e("el-option",{key:t.validue,attrs:{label:t.name,value:t.code}})})),1)],1),e("el-form-item",[e("el-button",{class:["login-btn",{"btn-margin":t.productList.length<2&&t.hosptailList.length<2}],attrs:{type:"primary",loading:t.logining,disabled:!t.hosptailList.length&&!t.productList.length},on:{click:t.handleSubmit}},[t._v("\n            登录\n          ")])],1)],1)],1),e("div",{staticClass:"versoin"},[t._v("\n      © 2019 Winning Health 版权所有\n    ")])])])},n=[],i=(o("7afe"),o("e5b4"),o("1bc7"),o("fc02"),o("d91d"),o("f13c")),s=o("ae5e"),a=o("acac"),c=o("2ad3"),l=o("e0e5"),u=o("fd63"),d=o("e4a1"),f=o("2da9");function h(t){var e=p();return function(){var o,r=Object(l["a"])(t);if(e){var n=Object(l["a"])(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return Object(c["a"])(this,o)}}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var g=function(t){Object(a["a"])(o,t);var e=h(o);function o(){var t;return Object(i["a"])(this,o),t=e.apply(this,arguments),t.logining=!1,t.loginForm={account:"",password:"",productId:"",hosptailId:""},t.formRules={account:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],productId:[{required:!0,message:"请选择产品",trigger:"change"}],hosptailId:[{required:!0,message:"请选择医院",trigger:"change"}]},t.hosptailList=[],t.productList=[],t.hospitalId="",t.usercode="",t.passeord="",t.isShow=!1,t.baseSysVersion="",t}return Object(s["a"])(o,[{key:"created",value:function(){this.$store.commit("SET_TOKEN",""),this.listAllProducts(),this.getMasterInstitution(),this.getSystemVersion(),this.listAllInstitutions()}},{key:"mounted",value:function(){this.getRequsestSso()}},{key:"getQueryString",value:function(){for(var t={},e=location.search.substring(1),o=e.split("&"),r=0;r<o.length;r++){var n=o[r].indexOf("=");if(-1!==n){var i=o[r].substring(0,n),s=o[r].substring(n+1);t[i]=unescape(s)}}return t.propertySize=o.length,t}},{key:"getRequsestSso",value:function(){if(this.params=this.getQueryString(),7===this.params.propertySize&&this.params.ptflag)if("2"===this.params.loginflag){this.usercode=this.params.loginid;var t=this;setTimeout((function(){t.loginFromSSO(t.params.loginid,"",t.hospitalId,!1)}),500)}else this.isShow=!0;else this.isShow=!0}},{key:"handleSubmit",value:function(){var t=this;this.$refs.loginForm.validate((function(e){if(!e)return!1;t.loginFromSSO(t.loginForm.account,t.loginForm.password,t.loginForm.hosptailId,!0)}))}},{key:"loginFromSSO",value:function(t,e,o,r){var n=this,i=this.params;i.usercode=t?f["Base64"].encode(t):t,i.password=e?f["Base64"].encode(e):e,i.yljgdm=o,i.productCode=this.loginForm.productId?this.loginForm.productId:"01",this.$api.loginFromSSO(i).then((function(t){var e=t.data||{};if(n.$store.commit("SET_ISKNOWLEDGE",e.data.isKnowledge),e.data.token){n.$store.commit("SET_TOKEN",e.data.token);var o=e.data.productList||[];o.length||n.$message.error("该账号未配置任何菜单，请更换账号！");var r=0;if(console.log("this.loginForm.productId："+n.loginForm.productId),o.forEach((function(t){r+=t.menuList.length;var e=n.productList.find((function(e){return e.code===t.code}))||{};console.log("SET_SYSTEM_VERSION"),t.code===n.loginForm.productId&&(console.log("item.code === this.loginForm.productId:"+t.code),console.log("SET_SYSTEM_VERSION:"+e.version),n.$store.commit("SET_SYSTEM_VERSION",e.version||"")),"00"===t.code?n.$set(t,"version",n.baseSysVersion||""):n.$set(t,"version",e.version||"")})),r){n.$store.commit("SET_USER_ACCOUNT",n.loginForm.account),n.$store.commit("SET_USER_NAME",e.data.fullname||""),n.$store.commit("SET_HOSPITAL_ID",i.yljgdm),n.$store.commit("SET_HOSPITAL_LIST",n.hosptailList),n.hosptailList.length&&n.$store.commit("SET_CONFIG_HOSPITAL_ID",n.hosptailList[0].code),n.$store.commit("SET_ACTIVE_PRO_ID",i.productCode),n.$store.commit("SET_MENU_LIST",o),n.$store.commit("SET_USER_CODE",e.data.usercode||""),sessionStorage.setItem("hasLogin",JSON.stringify(1));var s=o.find((function(t){return t.code===i.productCode})).menuList;if(null==s)n.$message.error("该账号未配置该产品菜单，请更换产品！"),n.logining=!1;else{if(null==s[0].redirect||""===s[0].redirect)return n.$message.error("菜单重定向错误，请联系管理员！"),void(n.logining=!1);n.$router.push(s[0].redirect)}}else n.$message.error("该账号未配置任何菜单，请更换账号！"),n.logining=!1}else n.$message.error("token未获取，请联系管理员！")})).catch((function(t){n.logining=!1}))}},{key:"listAllInstitutions",value:function(){var t=this;this.$api.listAllInstitutions().then((function(e){t.hosptailList=e.data||[]})).catch((function(t){}))}},{key:"listAllProducts",value:function(){var t=this;this.$api.listAllProducts().then((function(e){t.productList=e.data||[],t.$store.commit("SET_PRODUCT_LIST",t.productList),t.productList.length>0&&(t.loginForm.productId=t.productList[0].code)})).catch((function(t){}))}},{key:"getMasterInstitution",value:function(){var t=this;this.$api.getMainInstitution().then((function(e){t.hospitalId=e.data.code,t.$store.commit("SET_MASTER_INSTITUTION",e.data)})).catch((function(t){}))}},{key:"getSystemVersion",value:function(){var t=this;this.$api.getSystemVersion().then((function(e){t.$store.commit("SET_SYSTEM_VERSION",e.data),t.baseSysVersion=e.data})).catch((function(t){}))}}]),o}(d["c"]);g=Object(u["a"])([Object(d["a"])({name:"ssoRedirect"})],g);var m=g,v=m,S=(o("ba2a"),o("0b56")),y=Object(S["a"])(v,r,n,!1,null,"6345c761",null);e["default"]=y.exports},ba2a:function(t,e,o){"use strict";o("2646")}}]);