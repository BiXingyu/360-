(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65a51e99"],{"3da6":function(e,t,r){"use strict";r("7c1c")},6407:function(e,t,r){"use strict";var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total,"pager-count":e.pagerCount},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})},a=[],o=(r("7afe"),r("f13c")),i=r("ae5e"),l=r("acac"),n=r("2ad3"),u=r("e0e5"),d=r("fd63"),c=r("e4a1");function m(e){var t=p();return function(){var r,s=Object(u["a"])(e);if(t){var a=Object(u["a"])(this).constructor;r=Reflect.construct(s,arguments,a)}else r=s.apply(this,arguments);return Object(n["a"])(this,r)}}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var f=function(e){Object(l["a"])(r,e);var t=m(r);function r(){return Object(o["a"])(this,r),t.apply(this,arguments)}return Object(i["a"])(r,[{key:"currentPage",get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},{key:"pageSize",get:function(){return this.size},set:function(e){this.$emit("update:size",e)}},{key:"handleSizeChange",value:function(e){this.currentPage=1,this.$emit("getTableData")}},{key:"handleCurrentChange",value:function(e){this.$emit("getTableData")}}]),r}(c["c"]);Object(d["a"])([Object(c["b"])({required:!0})],f.prototype,"total",void 0),Object(d["a"])([Object(c["b"])({default:1})],f.prototype,"page",void 0),Object(d["a"])([Object(c["b"])({default:10})],f.prototype,"size",void 0),Object(d["a"])([Object(c["b"])({default:7})],f.prototype,"pagerCount",void 0),Object(d["a"])([Object(c["b"])({default:function(){return[10,20,30,50]}})],f.prototype,"pageSizes",void 0),Object(d["a"])([Object(c["b"])({default:"total, sizes, prev, pager, next, jumper"})],f.prototype,"layout",void 0),f=Object(d["a"])([Object(c["a"])({name:"pagination"})],f);var h=f,b=h,g=(r("84c7"),r("0b56")),v=Object(g["a"])(b,s,a,!1,null,"7e267c7f",null);t["a"]=v.exports},"7c1c":function(e,t,r){},"84c7":function(e,t,r){"use strict";r("f180")},"8d60":function(e,t,r){"use strict";r("95d6")},"95d6":function(e,t,r){},a349:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var s=r("3753"),a=r("7736"),o=i("computed",a["e"]);i("computed",a["c"]),i("methods",a["b"]),i("methods",a["d"]);function i(e,t){function r(r,a){return Object(s["a"])((function(s,o){s[e]||(s[e]={});var i,l=(i={},i[o]=r,i);s[e][o]=void 0!==a?t(a,l)[o]:t(l)[o]}))}function a(e,t){if("string"===typeof t){var s=t,a=e;return r(s,void 0)(a,s)}var o=l(t),i=e;return r(i,o)}return a}function l(e){var t=e&&e.namespace;if("string"===typeof t)return"/"!==t[t.length-1]?t+"/":t}},cc4c:function(e,t,r){"use strict";r.r(t);r("a450");var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"user flex flex-v"},[t("div",{staticClass:"search flex flex-pack-justify-between"},[t("div",{staticClass:"condition"},[t("el-input",{staticClass:"w-200",attrs:{placeholder:"请输入账号，姓名",clearable:!0},on:{clear:e.getUserListByKeyWords},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getUserListByKeyWord.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("el-button",{staticClass:"add",attrs:{type:"primary"},on:{click:e.getUserListByKeyWord}},[e._v("\n        查询\n      ")])],1),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAddBtnClick}},[e._v("新增")])],1),t("div",{staticClass:"content-main flex-1 mt-10"},[t("el-table",{attrs:{data:e.dataList}},[t("el-table-column",{attrs:{type:"index",label:"#","min-width":"50"}}),t("el-table-column",{attrs:{prop:"usercode",label:"登录名","min-width":"120"}}),t("el-table-column",{attrs:{prop:"fullname",label:"姓名","min-width":"120"}}),t("el-table-column",{attrs:{prop:"roleName",label:"角色","min-width":"120"}}),t("el-table-column",{attrs:{prop:"jgmc",label:"所属机构","min-width":"130"}}),t("el-table-column",{attrs:{prop:"enable",label:"是否启用","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(!0===t.row.enable?"是":!0!==t.row.enable?"否":"")+"\n        ")]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditBtnClick(r.row)}}},[e._v("\n            编辑\n          ")])]}}])})],1),t("pagination",{attrs:{page:e.page,size:e.size,total:e.total},on:{"update:page":function(t){e.page=t},"update:size":function(t){e.size=t},getTableData:e.getUserListByKeyWords}})],1),t("el-dialog",{attrs:{title:"编辑用户",visible:e.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t}}},[t("el-form",{ref:"userForm",attrs:{model:e.userForm,"label-width":"80px",rules:e.userFormRules}},[t("p",[t("span",[e._v("1.基础信息 ")]),t("b",[t("span",[e._v("("+e._s(e.userForm.usercode)+") ")])])]),t("br"),t("div",{staticClass:"w"},[t("el-form-item",{staticClass:"w-1",attrs:{label:"姓名",prop:"fullname"}},[t("el-input",{model:{value:e.userForm.fullname,callback:function(t){e.$set(e.userForm,"fullname",t)},expression:"userForm.fullname"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"性别",prop:"sex"}},[t("el-select",{staticClass:"w-3",attrs:{placeholder:"请选择"},model:{value:e.userForm.sex,callback:function(t){e.$set(e.userForm,"sex",t)},expression:"userForm.sex"}},e._l(e.sexList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.label}})})),1)],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"机构",prop:"jgdm"}},[t("el-select",{staticClass:"w-3",attrs:{placeholder:"请选择"},model:{value:e.userForm.jgdm,callback:function(t){e.$set(e.userForm,"jgdm",t)},expression:"userForm.jgdm"}},e._l(e.institutionList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),1)],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"角色",prop:"roleId"}},[t("el-select",{staticClass:"w-3",attrs:{placeholder:"请选择"},model:{value:e.userForm.roleId,callback:function(t){e.$set(e.userForm,"roleId",t)},expression:"userForm.roleId"}},e._l(e.roleList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"电话",prop:"mobilephone"}},[t("el-input",{attrs:{maxlength:"11"},model:{value:e.userForm.mobilephone,callback:function(t){e.$set(e.userForm,"mobilephone",t)},expression:"userForm.mobilephone"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"有效日期",prop:"updateTime"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.userForm.updateTime,callback:function(t){e.$set(e.userForm,"updateTime",t)},expression:"userForm.updateTime"}})],1),t("el-form-item",{staticClass:"w-2",attrs:{label:"搜索显示"}},[t("el-switch",{attrs:{"on-text":"是","off-text":"否"},model:{value:e.userForm.isTopShow,callback:function(t){e.$set(e.userForm,"isTopShow",t)},expression:"userForm.isTopShow"}})],1),e.userForm.isTopShow?t("span",{staticClass:"showPatinetSearch"},[t("el-radio",{staticClass:"radio",attrs:{label:"0"},model:{value:e.patinetSearch,callback:function(t){e.patinetSearch=t},expression:"patinetSearch"}},[e._v("\n            可搜索全部患者\n          ")]),t("el-radio",{staticClass:"radio radio2",attrs:{label:"1"},model:{value:e.patinetSearch,callback:function(t){e.patinetSearch=t},expression:"patinetSearch"}},[e._v("\n            仅可搜索近\n            "),t("el-input",{staticClass:"elInputs",attrs:{disabled:"0"===e.patinetSearch,type:"text",maxlength:"2",size:"mini"},on:{input:e.handleEdit},model:{value:e.searchTime,callback:function(t){e.searchTime=t},expression:"searchTime"}}),e._v("\n            月 就诊患者\n          ")],1)],1):e._e(),t("div",[t("el-form-item",{staticClass:"w-2",attrs:{label:"启用"}},[t("el-switch",{attrs:{"on-text":"是","off-text":"否"},model:{value:e.userForm.enable,callback:function(t){e.$set(e.userForm,"enable",t)},expression:"userForm.enable"}})],1),t("el-form-item",{staticClass:"w-2",attrs:{label:"解锁"}},[t("el-switch",{attrs:{"on-text":"是","off-text":"否"},model:{value:e.userForm.lock,callback:function(t){e.$set(e.userForm,"lock",t)},expression:"userForm.lock"}})],1),t("el-form-item",{staticClass:"w-2",attrs:{label:"解除登录"}},[t("el-switch",{attrs:{"on-text":"是","off-text":"否"},model:{value:e.userForm.load,callback:function(t){e.$set(e.userForm,"load",t)},expression:"userForm.load"}})],1)],1)],1),t("el-button",{staticClass:"w-4",attrs:{type:"primary"},on:{click:function(t){return e.updatePassword()}}},[e._v("\n        重置密码\n      ")]),t("p",[e._v("2.科室病区")]),t("br"),t("el-form-item",{staticClass:"ksbq",attrs:{label:"科室"}},[t("el-select",{staticClass:"w-3",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入科室"},on:{change:e.handleDeptSelectChange},nativeOn:{click:function(t){return e.tipsDept.apply(null,arguments)}},model:{value:e.userForm.deptCodes,callback:function(t){e.$set(e.userForm,"deptCodes",t)},expression:"userForm.deptCodes"}},e._l(e.deptList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),1)],1),t("el-form-item",{staticClass:"ksbq",attrs:{label:"病区"}},[t("el-select",{staticClass:"w-3",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入病区"},on:{change:e.handleWardSelectChange},nativeOn:{click:function(t){return e.tipsWard.apply(null,arguments)}},model:{value:e.userForm.wardCodes,callback:function(t){e.$set(e.userForm,"wardCodes",t)},expression:"userForm.wardCodes"}},e._l(e.wardList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){e.showDialog=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updateUser.apply(null,arguments)}}},[e._v("提交")])],1)],1),t("el-dialog",{attrs:{title:"新增用户",visible:e.showAddDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showAddDialog=t}}},[t("el-form",{ref:"userAddForm",attrs:{model:e.userAddForm,"label-width":"80px",rules:e.userAddFormRules}},[t("p",[e._v("1.基础信息")]),t("br"),t("div",{staticClass:"w"},[t("el-form-item",{staticClass:"w-1",attrs:{label:"账号",prop:"usercode"}},[t("el-input",{attrs:{maxlength:"20"},model:{value:e.userAddForm.usercode,callback:function(t){e.$set(e.userAddForm,"usercode",t)},expression:"userAddForm.usercode"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"姓名",prop:"fullname"}},[t("el-input",{model:{value:e.userAddForm.fullname,callback:function(t){e.$set(e.userAddForm,"fullname",t)},expression:"userAddForm.fullname"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.userAddForm.password,callback:function(t){e.$set(e.userAddForm,"password",t)},expression:"userAddForm.password"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"机构",prop:"jgdm"}},[t("el-select",{staticClass:"w-3",attrs:{placeholder:"请选择"},model:{value:e.userAddForm.jgdm,callback:function(t){e.$set(e.userAddForm,"jgdm",t)},expression:"userAddForm.jgdm"}},e._l(e.institutionList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),1)],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"角色",prop:"roleId"}},[t("el-select",{staticClass:"w-3",attrs:{placeholder:"请选择"},model:{value:e.userAddForm.roleId,callback:function(t){e.$set(e.userAddForm,"roleId",t)},expression:"userAddForm.roleId"}},e._l(e.roleList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"性别",prop:"sex"}},[t("el-select",{staticClass:"w-3",attrs:{placeholder:"请选择"},model:{value:e.userAddForm.sex,callback:function(t){e.$set(e.userAddForm,"sex",t)},expression:"userAddForm.sex"}},e._l(e.sexList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.label}})})),1)],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"电话",prop:"mobilephone"}},[t("el-input",{attrs:{maxlength:"11"},model:{value:e.userAddForm.mobilephone,callback:function(t){e.$set(e.userAddForm,"mobilephone",t)},expression:"userAddForm.mobilephone"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.userAddForm.email,callback:function(t){e.$set(e.userAddForm,"email",t)},expression:"userAddForm.email"}})],1),t("el-form-item",{staticClass:"w-1",attrs:{label:"有效日期",prop:"updateTime"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.userAddForm.updateTime,callback:function(t){e.$set(e.userAddForm,"updateTime",t)},expression:"userAddForm.updateTime"}})],1),t("el-form-item",{staticClass:"w-2",attrs:{label:"搜索显示"}},[t("el-switch",{attrs:{"on-text":"是","off-text":"否"},model:{value:e.userAddForm.isTopShow,callback:function(t){e.$set(e.userAddForm,"isTopShow",t)},expression:"userAddForm.isTopShow"}})],1),e.userAddForm.isTopShow?t("span",{staticClass:"showPatinetSearch"},[t("el-radio",{staticClass:"radio",attrs:{label:"0"},model:{value:e.patinetSearchAdd,callback:function(t){e.patinetSearchAdd=t},expression:"patinetSearchAdd"}},[e._v("\n            可搜索全部患者\n          ")]),t("el-radio",{staticClass:"radio radio2",attrs:{label:"1"},model:{value:e.patinetSearchAdd,callback:function(t){e.patinetSearchAdd=t},expression:"patinetSearchAdd"}},[e._v("\n            仅可搜索近\n            "),t("el-input",{staticClass:"elInputs",attrs:{disabled:"0"===e.patinetSearchAdd,type:"text",maxlength:"2",size:"mini"},on:{input:e.handleEditAdd},model:{value:e.searchTimeAdd,callback:function(t){e.searchTimeAdd=t},expression:"searchTimeAdd"}}),e._v("\n            月 就诊患者\n          ")],1)],1):e._e(),t("div",[t("el-form-item",{staticClass:"w-2",attrs:{label:"启用"}},[t("el-switch",{attrs:{"on-text":"是","off-text":"否"},model:{value:e.userAddForm.enable,callback:function(t){e.$set(e.userAddForm,"enable",t)},expression:"userAddForm.enable"}})],1)],1)],1),t("p",[e._v("2.科室病区")]),t("br"),t("el-form-item",{staticClass:"ksbq",attrs:{label:"科室"}},[t("el-select",{staticClass:"w-3",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入科室"},on:{change:e.handleDeptSelectChange},nativeOn:{click:function(t){return e.tipsDept.apply(null,arguments)}},model:{value:e.userAddForm.deptCodes,callback:function(t){e.$set(e.userAddForm,"deptCodes",t)},expression:"userAddForm.deptCodes"}},e._l(e.deptList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),1)],1),t("el-form-item",{staticClass:"ksbq",attrs:{label:"病区"}},[t("el-select",{staticClass:"w-3",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入病区"},on:{change:e.handleWardSelectChange},nativeOn:{click:function(t){return e.tipsWard.apply(null,arguments)}},model:{value:e.userAddForm.wardCodes,callback:function(t){e.$set(e.userAddForm,"wardCodes",t)},expression:"userAddForm.wardCodes"}},e._l(e.wardList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){e.showAddDialog=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addUser.apply(null,arguments)}}},[e._v("提交")])],1)],1)],1)},a=[],o=(r("ac67"),r("32ea"),r("7afe"),r("824a")),i=(r("1bc7"),r("fc02"),r("8dee"),r("f13c")),l=r("ae5e"),n=r("acac"),u=r("2ad3"),d=r("e0e5"),c=r("fd63"),m=r("e4a1"),p=r("6407"),f=r("a349"),h=r("2da9"),b=r("efb9");function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=y();return function(){var r,s=Object(d["a"])(e);if(t){var a=Object(d["a"])(this).constructor;r=Reflect.construct(s,arguments,a)}else r=s.apply(this,arguments);return Object(u["a"])(this,r)}}function y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var F=function(e){Object(n["a"])(r,e);var t=w(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.deptName="",e.wardName="",e.keyword="",e.sexList=[{label:"男"},{label:"女"},{label:"其他"}],e.page=1,e.size=10,e.total=0,e.dataList=[],e.roleList=[],e.institutionList=[],e.deptList=[],e.wardList=[],e.selectedWardList=[],e.showDialog=!1,e.showAddDialog=!1,e.oldJgdm="",e.patinetSearch="0",e.searchTime="",e.patinetSearchAdd="0",e.searchTimeAdd="",e.userForm={id:0,usercode:"",fullname:"",password:"",jgdm:"",roleId:"",sex:"",email:"",mobilephone:"",enable:!0,lock:!0,load:!0,createTime:"",updateTime:"",passFailNum:"",isTopShow:!1,deptCodes:[],wardCodes:[],passwordExpirySwitch:!1},e.userFormRules={fullname:[{required:!0,message:"请输入用户名称",trigger:"blur"}],jgdm:[{required:!0,message:"请选择一个机构",trigger:"blur"}],mobilephone:[{validator:e.validPhone,trigger:"blur"}],sex:[{required:!0,trigger:"blur",message:"请选择性别"}],updateTime:[{required:!0,trigger:"blur",message:"请选择有效时间"}],roleId:[{required:!0,message:"请选择一个角色",trigger:"blur"}]},e.userAddForm={id:0,usercode:"",fullname:"",password:"",jgdm:"",roleId:"",sex:"",email:"",mobilephone:"",updateTime:"",enable:!0,isTopShow:!1,deptCodes:[],wardCodes:[]},e.userAddFormRules={usercode:[{required:!0,validator:e.validExistUserCode,trigger:"blur"}],fullname:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{required:!0,validator:e.validPassword,trigger:"blur"}],jgdm:[{required:!0,message:"请选择一个机构",trigger:"blur"}],mobilephone:[{trigger:"blur",validator:e.validPhone}],sex:[{required:!0,trigger:"blur",message:"请选择性别"}],updateTime:[{required:!0,trigger:"blur",message:"请选择有效日期"}],roleId:[{required:!0,message:"请选择一个角色",trigger:"blur"}]},e}return Object(l["a"])(r,[{key:"showChange",value:function(){"0"===this.patinetSearch&&(this.searchTime="")}},{key:"showChangeAdd",value:function(){"0"===this.patinetSearchAdd&&(this.searchTimeAdd="")}},{key:"showUserAddFormIsTopShowChange",value:function(){this.patinetSearchAdd="0"}},{key:"mounted",value:function(){this.getUserListByKeyWords(),this.listAllRoles(),this.listAllInstitutions(),this.listDeptsByName(),this.listWardsByName()}},{key:"handleEdit",value:function(e){var t=e.replace(/^(0+)|[^\d]+/g,"");t=t.replace(/(\d{15})\d*/,"$1"),this.searchTime=t}},{key:"handleEditAdd",value:function(e){var t=e.replace(/^(0+)|[^\d]+/g,"");t=t.replace(/(\d{15})\d*/,"$1"),this.searchTimeAdd=t}},{key:"tipsDept",value:function(){0===this.deptList.length&&this.$message({message:"科室信息同步中，请检查抽取包是否正常！",type:"warning"})}},{key:"tipsWard",value:function(){0===this.wardList.length&&this.$message({message:"病区信息同步中，请检查抽取包是否正常！",type:"warning"})}},{key:"handleDeptSelectChange",value:function(){var e=this,t=[],r=this.userForm.deptCodes.filter((function(e){var t=e.split("___");return"-1"===t[1]}));r.forEach((function(e){t.push(e.split("___")[0])})),t.length>0&&(this.userForm.deptCodes=this.userForm.deptCodes.filter((function(e){var r=e.split("___");return t.indexOf(r[0])<0})),t.forEach((function(t){return e.userForm.deptCodes.push(t+"___-1")}))),t=[],r=this.userAddForm.deptCodes.filter((function(e){var t=e.split("___");return"-1"===t[1]})),r.forEach((function(e){t.push(e.split("___")[0])})),t.length>0&&(this.userAddForm.deptCodes=this.userAddForm.deptCodes.filter((function(e){var r=e.split("___");return t.indexOf(r[0])<0})),t.forEach((function(t){return e.userForm.deptCodes.push(t+"___-1")})))}},{key:"handleWardSelectChange",value:function(){var e=this,t=[],r=this.userForm.wardCodes.filter((function(e){var r=e.split("___");return"-1"===r[1]&&t.indexOf(r[0])<0}));r.forEach((function(e){t.push(e.split("___")[0])})),t.length>0&&(this.userForm.wardCodes=this.userForm.wardCodes.filter((function(e){var r=e.split("___");return t.indexOf(r[0])<0})),t.forEach((function(t){return e.userForm.wardCodes.push(t+"___-1")}))),t=[],r=this.userAddForm.wardCodes.filter((function(e){var r=e.split("___");return"-1"===r[1]&&t.indexOf(r[0])<0})),r.forEach((function(e){t.push(e.split("___")[0])})),t.length>0&&(this.userAddForm.wardCodes=this.userAddForm.wardCodes.filter((function(e){var r=e.split("___");return t.indexOf(r[0])<0})),t.forEach((function(t){return e.userForm.wardCodes.push(t+"___-1")})))}},{key:"updatePassword",value:function(){this.password()}},{key:"password",value:function(){var e=this,t={};t=sessionStorage.getItem("isLoginAes")?{usercode:b["a"].encrypt(this.userForm.usercode),jgdm:b["a"].encrypt(this.userForm.jgdm),roleId:this.userForm.roleId}:{usercode:h["Base64"].encode(this.userForm.usercode),jgdm:h["Base64"].encode(this.userForm.jgdm),roleId:this.userForm.roleId},this.$api.updatePassword(t).then((function(t){200===t.status?e.$message.success("密码重置为“abc123”"):e.$message.error("密码重置失败")})).catch((function(e){}))}},{key:"validPhone",value:function(e,t,r){/^(\(\d{3,4}\)|\d{3,4}-|\d{3,4}-\d{3,4}-|\s)?\d{11}$/.test(t)||""===t||null===t?r():r(new Error("请输入正确的电话/手机号码！"))}},{key:"validPassword",value:function(e,t,r){""===t?r(new Error("请输入密码")):/(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%&*~()-+=]+$)(?![0-9\\W_!@#$%^&*()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`()-+=]{8,12}$/.test(t)||""===t?r():r(new Error("必须包含8-12位大小字母、数字、符号至少3种"))}},{key:"handleAddBtnClick",value:function(){var e=this;this.userAddForm={id:0,usercode:"",fullname:"",password:"",jgdm:"",roleId:"",sex:"",email:"",mobilephone:"",updateTime:this.$moment("2099-12-30").format("YYYY-MM-DD"),enable:!0,isTopShow:!1,deptCodes:[],wardCodes:[]},this.showAddDialog=!0,this.$nextTick((function(){e.$refs.userAddForm.clearValidate()}))}},{key:"listUserDept",value:function(){var e=this,t={usercode:this.userForm.usercode,yljgdm:this.userForm.jgdm};this.$api.listUserDept(t).then((function(t){e.userForm.deptCodes=t.data||[]})).catch((function(){}))}},{key:"listUserWard",value:function(){var e=this,t={usercode:this.userForm.usercode,yljgdm:this.userForm.jgdm};this.$api.listUserWard(t).then((function(t){e.userForm.wardCodes=t.data||[]})).catch((function(){}))}},{key:"handleEditBtnClick",value:function(e){var t=this;this.userForm={id:e.id,usercode:e.usercode,fullname:e.fullname,password:e.password,jgdm:e.jgdm,roleId:e.roleId,sex:e.sex,email:e.email,mobilephone:e.mobilephone,enable:e.enable,lock:e.lock,load:e.load,isTopShow:e.isTopShow,createTime:e.createTime,updateTime:e.updateTime,passFailNum:e.passFailNum,deptCodes:this.userForm.deptCodes.join(","),wardCodes:this.userForm.wardCodes.join(","),passwordExpirySwitch:e.passwordExpirySwitch},this.oldJgdm=e.jgdm,e.isTopShow&&(e.searchTime&&"0"!==e.searchTime?(this.patinetSearch="1",this.searchTime=e.searchTime):this.patinetSearch="0"),this.listUserDept(),this.listUserWard(),this.showDialog=!0,this.$nextTick((function(){t.$refs.userForm.clearValidate()}))}},{key:"addUser",value:function(e){var t=this;this.$refs.userAddForm.validate((function(e){if(e){var r="";t.userAddForm.isTopShow?"0"===t.patinetSearchAdd?r="0":"1"===t.patinetSearchAdd&&(r=t.searchTimeAdd):r="",console.log(r,"searchTimeAdd"),t.$api.addUser(v(v({},t.userAddForm),{},{searchTime:r})).then((function(e){t.showAddDialog=!1,e.status&&200===e.status?(t.$message.success("添加成功"),t.getUserListByKeyWords()):t.$message.error("添加失败")})).catch((function(e){t.showAddDialog=!1}))}}))}},{key:"updateUser",value:function(e){var t=this;this.$refs.userForm.validate((function(e){if(t.userForm.updateTime=t.$moment(t.userForm.updateTime).utcOffset(8).format("YYYY-MM-DD HH:mm:ss"),e){var r="";t.userForm.isTopShow?"0"===t.patinetSearch?r="0":"1"===t.patinetSearch&&(r=t.searchTime):r="",t.$api.updateUser(v(v({},t.userForm),{},{searchTime:r})).then((function(e){t.showDialog=!1,200===e.status?t.userForm.jgdm!==t.oldJgdm&&t.userForm.usercode===t.userCode?(t.$message.success("更新成功,机构代码变更，请重新登陆"),t.$router.push("/login")):(t.$message.success("更新用户信息成功"),t.getUserListByKeyWords()):t.$message.error("更新用户信息失败")})).catch((function(e){t.showDialog=!1,t.$message.error("更新用户信息失败")}))}}))}},{key:"validExistUserCode",value:function(e,t){var r=this;return new Promise((function(e,s){return""===t?s("请输入模块编码"):/^\w{1,20}$/.test(t)||""===t?void r.$api.existUser({usercode:r.userAddForm.usercode,jgdm:r.userAddForm.jgdm}).then((function(t){return!0===t.data?s("用户已存在！"):e()})).catch((function(e){})):s("请输入1-20个字母/数字/下划线")}))}},{key:"getUserListByKeyWord",value:function(){this.page=1,this.getUserListByKeyWords()}},{key:"getUserListByKeyWords",value:function(){var e=this,t={keyword:this.keyword,page:this.page,size:this.size};this.$api.listUserByKeyword(t).then((function(t){var r=t.data||{};r.content&&(e.dataList=r.content,e.total=r.totalElements||0)})).catch((function(){}))}},{key:"listAllRoles",value:function(){var e=this;this.$api.listAllRoles().then((function(t){var r=t.data||[];e.roleList=r.map((function(e){return{id:e.id,name:e.name}}))})).catch((function(e){}))}},{key:"listAllInstitutions",value:function(){var e=this;this.$api.listAllInstitutions().then((function(t){var r=t.data||[];e.institutionList=r.map((function(e){return{code:e.code,name:e.name}}))})).catch((function(e){}))}},{key:"listDeptsByName",value:function(){var e=this;this.$api.listDeptsByName({name:this.deptName}).then((function(t){var r=t.data||[];e.deptList=r.map((function(e){return{code:e.uniqueKey,name:e.name+"_"+e.yljgmc}}))})).catch((function(e){}))}},{key:"listWardsByName",value:function(){var e=this;this.$api.listWardsByName({name:this.wardName}).then((function(t){var r=t.data||[];e.wardList=r.map((function(e){return{code:e.uniqueKey,name:e.name+"_"+e.yljgmc}}))})).catch((function(e){}))}}]),r}(m["c"]);Object(c["a"])([f["a"]],F.prototype,"userCode",void 0),Object(c["a"])([Object(m["d"])("patinetSearch")],F.prototype,"showChange",null),Object(c["a"])([Object(m["d"])("patinetSearchAdd")],F.prototype,"showChangeAdd",null),Object(c["a"])([Object(m["d"])("userAddForm.isTopShow")],F.prototype,"showUserAddFormIsTopShowChange",null),F=Object(c["a"])([Object(m["a"])({name:"User",components:{pagination:p["a"]}})],F);var k=F,C=k,A=(r("8d60"),r("3da6"),r("0b56")),x=Object(A["a"])(C,s,a,!1,null,"65b39e70",null);t["default"]=x.exports},f180:function(e,t,r){}}]);