(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fa0fe50"],{"31dc":function(t,n,e){},"3e07":function(t,n,e){"use strict";e("31dc")},"61df":function(t,n,e){"use strict";e.r(n);e("a450");var i=function(){var t=this,n=t._self._c;t._self._setupProxy;return n("div",{staticClass:"institution"},[n("div",{staticClass:"search flex flex-pack-justify-between flex-align-center"},[n("span",[n("el-input",{staticClass:"keyword",attrs:{placeholder:"请输入机构代码，名称",clearable:""},on:{clear:t.listInstitutions},nativeOn:{keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.listInstitutions.apply(null,arguments)}},model:{value:t.keyword,callback:function(n){t.keyword=n},expression:"keyword"}}),n("el-button",{staticClass:"query-btn",attrs:{type:"primary"},on:{click:t.listInstitutions}},[t._v("\n        查询\n      ")])],1),n("el-button",{staticClass:"my-btn",attrs:{type:"primary"},on:{click:t.handleAddBtnClick}},[t._v("\n      新增\n    ")])],1),n("el-table",{staticClass:"custom-table",attrs:{data:t.dataList,"highlight-current-row":"","header-row-class-name":"table-header"}},[n("el-table-column",{attrs:{type:"index","min-width":"80"}}),n("el-table-column",{attrs:{prop:"code",label:"医疗机构代码","min-width":"120"}}),n("el-table-column",{attrs:{prop:"name",label:"医疗机构名称","min-width":"360"}}),n("el-table-column",{attrs:{prop:"grade",label:"是否主院",formatter:t.formatGrade,"min-width":"120",align:"center"}}),n("el-table-column",{attrs:{label:"操作","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.handleEditBtnClick(e.row)}}},[t._v("\n          编辑\n        ")]),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return t.handleDeleteBtnClick(e.row.code,e.row.name)}}},[t._v("\n          删除\n        ")])]}}])})],1),n("el-dialog",{attrs:{title:"add"===this.operationType?"新增机构":"编辑机构",visible:t.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(n){t.showDialog=n}}},[n("el-form",{ref:"institutionForm",attrs:{model:t.institutionForm,"label-width":"110px",rules:t.institutionFormRules}},[n("el-form-item",{attrs:{label:"机构代码",prop:"code"}},[n("el-input",{attrs:{maxlength:50},model:{value:t.institutionForm.code,callback:function(n){t.$set(t.institutionForm,"code",n)},expression:"institutionForm.code"}})],1),n("el-form-item",{attrs:{label:"机构名称",prop:"name"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:t.institutionForm.name,callback:function(n){t.$set(t.institutionForm,"name",n)},expression:"institutionForm.name"}})],1),n("el-form-item",{attrs:{label:"是否主院"}},[n("el-switch",{attrs:{"on-text":"是","off-text":"否","active-value":1,"inactive-value":0},on:{change:t.checkMainInstitutionExist},model:{value:t.institutionForm.grade,callback:function(n){t.$set(t.institutionForm,"grade",n)},expression:"institutionForm.grade"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(n){return t.closeDialog.apply(null,arguments)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.submitInstitutionForm.apply(null,arguments)}}},[t._v("\n        提交\n      ")])],1)],1)],1)},o=[],a=(e("7afe"),e("f13c")),s=e("ae5e"),r=e("acac"),c=e("2ad3"),l=e("e0e5"),u=e("fd63"),d=e("e4a1");function f(t){var n=m();return function(){var e,i=Object(l["a"])(t);if(n){var o=Object(l["a"])(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return Object(c["a"])(this,e)}}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var h=function(t){Object(r["a"])(e,t);var n=f(e);function e(){var t;return Object(a["a"])(this,e),t=n.apply(this,arguments),t.dataList=[],t.keyword="",t.showDialog=!1,t.operationType="add",t.institutionForm={id:0,code:"",name:"",grade:0},t.institutionFormRules={code:[{validator:t.validExistCode,trigger:"blur"}],name:[{required:!0,message:"请输入机构名称",trigger:"blur"}]},t}return Object(s["a"])(e,[{key:"mounted",value:function(){this.listInstitutions()}},{key:"changeGrade",value:function(t,n){var e=this;this.$confirm("当前主院为【"+t+"】，是否修改？","已经存在主院",{}).then((function(){e.institutionForm.grade=1})).catch((function(){e.institutionForm.grade=n}))}},{key:"checkMainInstitutionExist",value:function(t){var n=this,e=1===t?0:1;this.institutionForm.grade=e,this.$api.getMainInstitution().then((function(i){var o=i.data;o&&(o.code===n.institutionForm.code&&0===t?(n.$message({message:"有且必须存在一个主院！",type:"warning"}),n.institutionForm.grade=1):n.changeGrade(o.name,e))})).catch((function(t){}))}},{key:"closeDialog",value:function(){this.showDialog=!1}},{key:"listInstitutions",value:function(){var t=this;this.$api.listInstitutions({keyword:this.keyword}).then((function(n){t.dataList=n.data||[]})).catch((function(t){}))}},{key:"formatGrade",value:function(t,n){return 1===t.grade?"是":"否"}},{key:"handleAddBtnClick",value:function(){var t=this;this.operationType="add",this.institutionForm={id:0,code:"",name:"",grade:0},this.showDialog=!0,this.$nextTick((function(){t.$refs.institutionForm.clearValidate()}))}},{key:"handleDeleteBtnClick",value:function(t,n){var e=this;this.$confirm("确认删除【"+n+"】该机构吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.deleteInstitution(t)})).catch((function(){}))}},{key:"handleEditBtnClick",value:function(t){var n=this;this.institutionForm={id:t.id,code:t.code,name:t.name,grade:t.grade},this.operationType="edit",this.showDialog=!0,this.$nextTick((function(){n.$refs.institutionForm.clearValidate()}))}},{key:"deleteInstitution",value:function(t){var n=this;this.$api.deleteInstitution({code:t}).then((function(t){n.$notify({title:"成功",message:"删除成功！",type:"success"}),n.listInstitutions()})).catch((function(t){}))}},{key:"submitInstitutionForm",value:function(t){var n=this;this.$refs.institutionForm.validate((function(t){if(t){var e="add"===n.operationType?"添加成功！":"修改成功！";"add"===n.operationType?n.$api.addInstitution(n.institutionForm).then((function(t){n.showDialog=!1,n.$message({message:e,type:"success"}),n.listInstitutions()})).catch((function(t){})):n.$api.updateInstitution(n.institutionForm).then((function(t){n.showDialog=!1,n.$message({message:e,type:"success"}),n.listInstitutions()})).catch((function(t){}))}}))}},{key:"validExistCode",value:function(t,n){var e=this;return new Promise((function(t,i){""===n&&i("机构编码不能为空！"),e.$api.existInstitution({code:e.institutionForm.code,id:e.institutionForm.id}).then((function(n){return!0===n.data?i("机构编码已存在！"):t()})).catch((function(t){}))}))}}]),e}(d["c"]);h=Object(u["a"])([Object(d["a"])({name:"Institution"})],h);var p=h,y=p,v=(e("3e07"),e("0b56")),g=Object(v["a"])(y,i,o,!1,null,"20d55546",null);n["default"]=g.exports}}]);