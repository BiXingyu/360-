(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70f36120"],{"04d1":function(e,t,a){var n=a("342f"),o=n.match(/firefox\/(\d+)/i);e.exports=!!o&&+o[1]},"14a5":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r}));a("b0c0");var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n="1.23452384164.123412415";null!==document.getElementById(n)&&document.body.removeChild(document.getElementById(n));var o=document.createElement("canvas"),r=o.getContext("2d");if(o.width=500,o.height=200,r.rotate(-15*Math.PI/180),"text"===e)r.font="20px Vedana",r.fillStyle="#666666",r.textAlign="center",r.textBaseline="Middle",r.fillText(t,o.width/2,o.height),r.fillText(a,o.width/2,o.height+22);else{var i=new Image;i.setAttribute("crossOrigin","Anonymous"),i.src="png"===e?"data:image/png;base64,"+t:"data:image/jpeg;base64,"+t}var s=document.createElement("div");return s.id=n,window.CONFIG.HospitalMessage&&"北京大学人民医院"===window.CONFIG.HospitalMessage.name&&(s.style.display="none"),s.style.pointerEvents="none",s.style.top="40px",s.style.left="0px",s.style.opacity="0.15",s.style.position="fixed",s.style.zIndex="100000",s.style.width=document.documentElement.clientWidth+"px",s.style.height=document.documentElement.clientHeight+"px","text"===e?s.style.background="url("+o.toDataURL("image/png")+") left top repeat":i.onload=function(){r.drawImage(i,200,200),s.style.background="url("+o.toDataURL("image/png")+") left top repeat"},document.body.appendChild(s),n},o=function(e,t,a){var o=n(e,t,a);null===document.getElementById(o)&&(o=n(e,t,a))},r=function(){var e="1.23452384164.123412415";null!==document.getElementById(e)&&document.body.removeChild(document.getElementById(e))}},"1f4a":function(e,t,a){"use strict";a("36bf")},"36bf":function(e,t,a){},"4e82":function(e,t,a){"use strict";var n=a("23e7"),o=a("e330"),r=a("59ed"),i=a("7b0b"),s=a("07fa"),l=a("577e"),c=a("d039"),d=a("addb"),u=a("a640"),f=a("04d1"),p=a("d998"),h=a("2d00"),m=a("512c"),g=[],b=o(g.sort),y=o(g.push),v=c((function(){g.sort(void 0)})),C=c((function(){g.sort(null)})),w=u("sort"),D=!c((function(){if(h)return h<70;if(!(f&&f>3)){if(p)return!0;if(m)return m<603;var e,t,a,n,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:a=3;break;case 68:case 71:a=4;break;default:a=2}for(n=0;n<47;n++)g.push({k:t+n,v:a})}for(g.sort((function(e,t){return t.v-e.v})),n=0;n<g.length;n++)t=g[n].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}})),I=v||!C||!w||!D,k=function(e){return function(t,a){return void 0===a?-1:void 0===t?1:void 0!==e?+e(t,a)||0:l(t)>l(a)?1:-1}};n({target:"Array",proto:!0,forced:I},{sort:function(e){void 0!==e&&r(e);var t=i(this);if(D)return void 0===e?b(t):b(t,e);var a,n,o=[],l=s(t);for(n=0;n<l;n++)n in t&&y(o,t[n]);d(o,k(e)),a=o.length,n=0;while(n<a)t[n]=o[n++];while(n<l)delete t[n++];return t}})},"4ec9":function(e,t,a){"use strict";var n=a("6d61"),o=a("6566");n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),o)},"4fad":function(e,t,a){var n=a("d039"),o=a("861d"),r=a("c6b6"),i=a("d86b"),s=Object.isExtensible,l=n((function(){s(1)}));e.exports=l||i?function(e){return!!o(e)&&((!i||"ArrayBuffer"!=r(e))&&(!s||s(e)))}:s},"512c":function(e,t,a){var n=a("342f"),o=n.match(/AppleWebKit\/(\d+)\./);e.exports=!!o&&+o[1]},6566:function(e,t,a){"use strict";var n=a("9bf2").f,o=a("7c73"),r=a("e2cc"),i=a("0366"),s=a("19aa"),l=a("2266"),c=a("7dd0"),d=a("2626"),u=a("83ab"),f=a("f183").fastKey,p=a("69f3"),h=p.set,m=p.getterFor;e.exports={getConstructor:function(e,t,a,c){var d=e((function(e,n){s(e,p),h(e,{type:t,index:o(null),first:void 0,last:void 0,size:0}),u||(e.size=0),void 0!=n&&l(n,e[c],{that:e,AS_ENTRIES:a})})),p=d.prototype,g=m(t),b=function(e,t,a){var n,o,r=g(e),i=y(e,t);return i?i.value=a:(r.last=i={index:o=f(t,!0),key:t,value:a,previous:n=r.last,next:void 0,removed:!1},r.first||(r.first=i),n&&(n.next=i),u?r.size++:e.size++,"F"!==o&&(r.index[o]=i)),e},y=function(e,t){var a,n=g(e),o=f(t);if("F"!==o)return n.index[o];for(a=n.first;a;a=a.next)if(a.key==t)return a};return r(p,{clear:function(){var e=this,t=g(e),a=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete a[n.index],n=n.next;t.first=t.last=void 0,u?t.size=0:e.size=0},delete:function(e){var t=this,a=g(t),n=y(t,e);if(n){var o=n.next,r=n.previous;delete a.index[n.index],n.removed=!0,r&&(r.next=o),o&&(o.previous=r),a.first==n&&(a.first=o),a.last==n&&(a.last=r),u?a.size--:t.size--}return!!n},forEach:function(e){var t,a=g(this),n=i(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:a.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!y(this,e)}}),r(p,a?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return b(this,0===e?0:e,t)}}:{add:function(e){return b(this,e=0===e?0:e,e)}}),u&&n(p,"size",{get:function(){return g(this).size}}),d},setStrong:function(e,t,a){var n=t+" Iterator",o=m(t),r=m(n);c(e,t,(function(e,t){h(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){var e=r(this),t=e.kind,a=e.last;while(a&&a.removed)a=a.previous;return e.target&&(e.last=a=a?a.next:e.state.first)?"keys"==t?{value:a.key,done:!1}:"values"==t?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),a?"entries":"values",!a,!0),d(t)}}},"67f0":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"patient_view_container"},[n("el-row",{ref:"filterPart",staticClass:"filterArea"},[n("el-radio-group",{staticClass:"radioGroup",on:{change:e.handleSuffererTypeChange},model:{value:e.suffererType,callback:function(t){e.suffererType=t},expression:"suffererType"}},[n("el-radio-button",{attrs:{label:"4"}},[e._v(" 检索 ")]),n("el-radio-button",{attrs:{label:"3"}},[e._v("门/急诊")]),n("el-radio-button",{attrs:{label:"1"}},[e._v("在院患者")]),n("el-radio-button",{attrs:{label:"2"}},[e._v("我的患者")])],1),1*e.suffererType===1||1*e.suffererType===2?[n("el-select",{staticClass:"query_area",attrs:{placeholder:"请选择科室",filterable:"",clearable:""},on:{change:e.drapSelectChangeFn},model:{value:e.initSelectValue,callback:function(t){e.initSelectValue=t},expression:"initSelectValue"}},e._l(e.DepartmentList,(function(e){return n("el-option",{key:e.departmentCode+e.departmentName,attrs:{label:e.departmentName+"("+e.yljgmc+")",value:e.departmentCode+"-"+e.yljgdm}})})),1),"0"!==e.showSearchInput?n("div",{staticClass:"query_key"},[n("el-input",{attrs:{placeholder:"支持姓名/身份证/病历号/院内卡号/医保卡号/联系电话"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.pop.doShow()}},model:{value:e.query_key,callback:function(t){e.query_key=t},expression:"query_key"}})],1):e._e(),n("el-popover",{ref:"pop",attrs:{placement:"bottom",width:"1100",trigger:"click",transition:"el-zoom-in-top",disabled:e.showPop,"popper-class":"SearchPopperOptions"},on:{show:e.loadTableInfo}},[n("el-table",{staticClass:"tableWrap",attrs:{data:e.searchDataList,height:"50vh"},on:{"row-click":e.clickData}},[n("el-table-column",{attrs:{"min-width":"90",label:"门诊号/住院号",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("4"===t.row.encounterTypeNo?t.row.imrn:t.row.omrn)+" ")]}}],null,!1,2827653553)}),n("el-table-column",{attrs:{"min-width":"80",property:"fullName",label:"患者姓名",align:"center","show-overflow-tooltip":!0}}),n("el-table-column",{attrs:{width:"70",property:"genderName",label:"性别",align:"center"}}),n("el-table-column",{attrs:{width:"70",label:"年龄",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.ageYear?n("span",[e._v(" "+e._s(t.row.ageYear+"岁"||!1)+" ")]):e._e()]}}],null,!1,2104544986)}),n("el-table-column",{attrs:{"min-width":"100",label:"出生日期","show-overflow-tooltip":!0,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.birthDate&&t.row.birthDate.length>11?n("span",[e._v(" "+e._s(t.row.birthDate.substr(0,11))+" ")]):e._e()]}}],null,!1,3332151654)}),n("el-table-column",{attrs:{"min-width":"100",property:"currentDeptName",label:"最后就诊科室","show-overflow-tooltip":!0,align:"left","header-align":"center"}}),n("el-table-column",{attrs:{width:"120",label:"最后就诊","show-overflow-tooltip":!0,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.visitStartTime?t.row.visitStartTime:"--")+" ")]}}],null,!1,3391546136)}),n("el-table-column",{attrs:{"min-width":"160",label:"地址","show-overflow-tooltip":!0,align:"left","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(" "+e._s(t.row.personAddress&&t.row.personAddress.length>0?t.row.personAddress[0].addrDetail:"--")+" ")])]}}],null,!1,4286399718)}),n("el-table-column",{attrs:{"min-width":"140",property:"idcardNo",label:"证件号",align:"center"}}),n("el-table-column",{attrs:{"min-width":"100",label:"联系电话",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(" "+e._s(t.row.personContactTelephone&&t.row.personContactTelephone.length>0?t.row.personContactTelephone[0].contactNo:"--")+" ")])]}}],null,!1,1065092471)})],1),"0"!==e.showSearchInput?n("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[e._v(" 高级搜索 ")]):e._e()],1),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"show",rawName:"v-show",value:e.selectTabCardList.length>0,expression:"selectTabCardList.length > 0"}],ref:"sufferer_list",staticClass:"sufferer_list",class:{componentList:e.isComponent},attrs:{id:"sufferer_list"}},[[n("el-backtop",{staticClass:"elBacktop",attrs:{target:"#sufferer_list","visibility-height":200,right:40,bottom:40}},[n("i",{staticClass:"el-icon-caret-top backTopicon"}),n("span",{staticClass:"backTopText"},[e._v("回到"),n("br"),e._v("顶部")])])],e._l(e.selectTabCardList,(function(t,o){return[n("div",{key:o,staticClass:"sufferer_card"},[n("div",{staticClass:"sufferer_user",on:{click:function(a){return e.clickPatientCard(t)}}},[n("img",{staticClass:"user-avatar",attrs:{src:t.genderName&&t.genderName.indexOf("男")>-1?e.iconMan:e.iconWoman}}),n("p",{staticClass:"text_bed"},[e._v(" "+e._s(t.inpBed&&t.inpBed.length>0?t.inpBed[0].bedNo:t.inpatBedInUse&&t.inpatBedInUse.length>0?t.inpatBedInUse[0].bedNo:"-")+" "),n("span",[e._v("床")])]),n("p",{staticClass:"text_user"},[e._v(" "+e._s(t.fullName||"-")+" "),n("i",{staticClass:"sep_line"}),n("span",[e._v(e._s((t.ageYear||"-")+"岁"))]),n("img",{staticClass:"i_sex",attrs:{src:t.genderName&&t.genderName.indexOf("男")>-1?e.iMan:e.iWoman}})]),n("div",{staticClass:"sufferer_symptom"},[t.showAllergy?n("span",{staticClass:"text_symptom"},[e._v("敏")]):e._e(),1===t.severityLevelCode?n("span",{staticClass:"text_rating_1"},[e._v("I")]):e._e(),2===t.severityLevelCode?n("span",{staticClass:"text_rating_2"},[e._v("II")]):e._e(),3===t.severityLevelCode?n("span",{staticClass:"text_rating_3"},[e._v("III")]):e._e()])]),n("div",{staticClass:"sufferer_illness"},[n("div",{staticClass:"sufferer_illness_detail"},[n("img",{staticClass:"info-avatar",attrs:{src:a("b54f")}}),n("span",{directives:[{name:"win-show-tips",rawName:"v-win-show-tips"}]},[e._v("病情诊断")]),n("div",{directives:[{name:"win-show-tips",rawName:"v-win-show-tips"}],staticClass:"card-row-value",on:{mouseover:function(a){return e.onMouseOver(t.viewDiagnosisPrincipal[0].diagnosisName)}}},[e._v(" "+e._s(t.viewDiagnosisPrincipal&&t.viewDiagnosisPrincipal.length>0?t.viewDiagnosisPrincipal[0].diagnosisName:"")+" ")])]),n("p",{staticClass:"sufferer_illness_detail"},[n("img",{staticClass:"info-avatar",attrs:{src:a("45d0")}}),e._v(" 主管医生 "),n("span",{staticClass:"card-row-value"},[e._v(e._s(t.scheduledDoctorName||"-"))])]),n("p",{staticClass:"sufferer_illness_detail"},[n("img",{staticClass:"info-avatar",attrs:{src:a("efbb")}}),e._v(" 入院天数 "),n("span",{staticClass:"card-row-value"},[e._v(e._s((t.inHospitalDays||"-")+"天"))])]),n("div",{staticClass:"sufferer_focus"},[t.showFollowed?n("img",{staticClass:"i_icon",attrs:{src:a("8430")},on:{click:function(a){return e.handleAlFocus(t)}}}):n("i",{staticClass:"el-icon-star-off i_icon",on:{click:function(a){return e.handleShowFocus(t)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showAlFocusHandle&&e.currentClickPatientNo===t.encounterId+"+"+t.encounterTypeNo,expression:"\n                    showAlFocusHandle &&\n                    currentClickPatientNo ===\n                      `${item.encounterId}+${item.encounterTypeNo}`\n                  "}],staticClass:"focus_dialog"},[n("p",{staticClass:"al_focus_btn",on:{click:function(a){return e.cancelGroup(t)}}},[e._v(" 取消关注 ")]),n("p",{staticClass:"al_focus_btn",on:{click:function(a){return e.handleEditGroup(t)}}},[e._v(" 编辑分组 ")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showGroupList&&e.currentClickPatientNo===t.encounterId+"+"+t.encounterTypeNo,expression:"\n                    showGroupList &&\n                    currentClickPatientNo ===\n                      `${item.encounterId}+${item.encounterTypeNo}`\n                  "}],staticClass:"focus_dialog add_focus"},[n("div",{staticClass:"top_info"},[n("p",{staticClass:"title"},[e._v("分组")]),n("p",{staticClass:"add_group",on:{click:function(t){e.showAddGroup=!e.showAddGroup}}},[e._v(" 创建分组 ")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showAddGroup,expression:"showAddGroup"}],staticClass:"add_group_name"},[n("el-input",{attrs:{type:"text",placeholder:"请输入内容",maxlength:"16"},model:{value:e.addGroupName,callback:function(t){e.addGroupName=t},expression:"addGroupName"}}),n("i",{staticClass:"el-icon-check addIcon",on:{click:e.confirmAddGroup}})],1),n("div",{staticClass:"group_list"},e._l(e.enableGroupList,(function(t){return n("div",{key:t.id},[n("el-checkbox",{attrs:{disabled:e.showAddGroup},model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item1.checked"}},[e._v(e._s(t.groupName))])],1)})),0),n("div",{staticClass:"btn"},[n("el-button",{on:{click:function(t){e.showGroupList=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary",disabled:e.showAddGroup},on:{click:function(a){return e.confirmFocus(t)}}},[e._v(" 确认 ")])],1)])])])])]}))],2)]:e._e(),1*e.suffererType===3?n("div",{staticClass:"todayDataFormListCss"},[n("el-form",{ref:"todayDataForm",staticClass:"elForm",attrs:{model:e.todayForm,inline:!0}},[n("el-form-item",{staticClass:"label",attrs:{label:"科室"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择科室",filterable:"",clearable:""},on:{change:e.drapSelectChangeFn},model:{value:e.initSelectValue,callback:function(t){e.initSelectValue=t},expression:"initSelectValue"}},e._l(e.DepartmentList,(function(e){return n("el-option",{key:e.departmentCode+e.departmentName,attrs:{label:e.departmentName+"("+e.yljgmc+")",value:e.departmentCode+"-"+e.yljgdm}})})),1)],1),n("el-form-item",{staticClass:"chooseDate",attrs:{label:"就诊日期"}},[n("el-date-picker",{staticClass:"timepicker itemContent",attrs:{type:"daterange","range-separator":"至","unlink-panels":"","value-format":"yyyy-MM-dd","picker-options":e.pickerBeginDateBefore},on:{change:e.timePickerChange,clear:e.handleClear},model:{value:e.todayForm.chooseDate,callback:function(t){e.$set(e.todayForm,"chooseDate",t)},expression:"todayForm.chooseDate"}})],1),n("el-form-item",{staticClass:"mzclass",attrs:{label:"门诊号"}},[n("el-input",{staticClass:"mzInput itemContent",attrs:{clearable:""},on:{clear:e.handleClear},model:{value:e.todayForm.omrnLike,callback:function(t){e.$set(e.todayForm,"omrnLike",t)},expression:"todayForm.omrnLike"}})],1),n("el-form-item",{staticClass:"nameclass",attrs:{label:"患者姓名"}},[n("el-input",{staticClass:"nameInput itemContent",attrs:{clearable:""},on:{clear:e.handleClear},model:{value:e.todayForm.fullNameLike,callback:function(t){e.$set(e.todayForm,"fullNameLike",t)},expression:"todayForm.fullNameLike"}})],1),e.showDepartmentClass?[n("el-form-item",{staticClass:"departmentClass",attrs:{label:"接诊医生"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择活动区域"},model:{value:e.todayForm.attendingDoctor,callback:function(t){e.$set(e.todayForm,"attendingDoctor",t)},expression:"todayForm.attendingDoctor"}},[n("el-option",{attrs:{label:"全部医生",value:""}}),e._l(e.dicList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.inpatientName,value:e.inpatientCode}})}))],2)],1)]:e._e(),n("el-form-item",{staticClass:"confirmClass itemContent"},[n("el-button",{attrs:{type:"primary"},on:{click:e.filterTodaytodayData}},[e._v(" 查询 ")])],1)],2),n("el-table",{staticClass:"el-table",staticStyle:{width:"100%"},attrs:{data:e.todayDataTableList,stripe:"",height:"67vh","header-cell-style":{background:"#ebeeff",color:"#606266",borderColor:"#ccc"},"row-class-name":e.rowStyle},on:{"row-dblclick":function(t,a,n){return e.clickPatientCard(t)}}},[n("template",{slot:"empty"},[n("p",[e._v(e._s(e.tableHasDataText))])]),e._l(e.tableContentList,(function(t){return n("el-table-column",{key:t.index,attrs:{label:t.label,"min-width":t.width,align:t.align,"header-align":t.headerAlign,"show-overflow-tooltip":t.tooltip},scopedSlots:e._u([{key:"default",fn:function(a){return["birthDate"===t.value||"visitStartTime"===t.value?[e._v(" "+e._s(a.row[t.value]?a.row[t.value].substr(0,11):"")+" ")]:[e._v(" "+e._s(a.row[t.value])+" ")]]}}],null,!0)})})),n("el-table-column",{attrs:{label:"联系电话","min-width":"120",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.bizRoleContactTelephone?t.row.bizRoleContactTelephone[0].contactNo:"--")+" ")]}}],null,!1,86886241)}),n("el-table-column",{attrs:{prop:"encounterStatusName",label:"就诊状态","min-width":"110",align:"center","header-align":"center"}}),n("el-table-column",{attrs:{label:"查阅","min-width":"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"handle"},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.clickPatientCard(t.row)}}},[e._v(" 查阅360 ")])],1)]}}],null,!1,710364781)})],2),n("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage1+1,"page-sizes":[50,100,500],"page-size":e.pageSize1,layout:"total, sizes, prev, pager, next, jumper",total:e.total1},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}})],1):e._e(),1*e.suffererType===4?n("div",{staticClass:"selfDfinedListCss"},[n("el-form",{ref:"selfDfinedForm",staticClass:"elForm",attrs:{model:e.selfDfinedForm,inline:!0}},[n("el-form-item",{staticClass:"mzclass",attrs:{label:"门诊号/住院号"}},[n("el-input",{staticClass:"selfDfinedMzInput itemContent",attrs:{clearable:""},on:{clear:e.handleClear},model:{value:e.selfDfinedForm.omrnLike,callback:function(t){e.$set(e.selfDfinedForm,"omrnLike",t)},expression:"selfDfinedForm.omrnLike"}})],1),n("el-form-item",{staticClass:"nameclass",attrs:{label:"患者姓名"}},[n("el-input",{staticClass:"selfDfinedNameInput itemContent",attrs:{clearable:""},on:{clear:e.handleClear},model:{value:e.selfDfinedForm.fullNameLike,callback:function(t){e.$set(e.selfDfinedForm,"fullNameLike",t)},expression:"selfDfinedForm.fullNameLike"}})],1),n("el-form-item",{staticClass:"nameclass",attrs:{label:"患者性别"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择活动区域"},model:{value:e.selfDfinedForm.sexType,callback:function(t){e.$set(e.selfDfinedForm,"sexType",t)},expression:"selfDfinedForm.sexType"}},[n("el-option",{attrs:{label:"全部",value:""}}),n("el-option",{attrs:{label:"男性",value:"50602"}}),n("el-option",{attrs:{label:"女性",value:"50603"}})],1)],1),n("el-form-item",{staticClass:"diagnoseClass",attrs:{label:"就诊类型"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择就诊类型"},model:{value:e.selfDfinedForm.diagnose,callback:function(t){e.$set(e.selfDfinedForm,"diagnose",t)},expression:"selfDfinedForm.diagnose"}},[n("el-option",{attrs:{label:"全部类型",value:""}}),n("el-option",{attrs:{label:"门诊",value:"1"}}),n("el-option",{attrs:{label:"住院",value:"4"}}),n("el-option",{attrs:{label:"急诊",value:"3"}})],1)],1),n("el-form-item",{staticClass:"chooseDate",attrs:{label:"就诊日期"}},[n("el-date-picker",{staticClass:"timepicker itemContent",attrs:{disabled:e.blockTimePick,type:"daterange","range-separator":"至","unlink-panels":"","value-format":"yyyy-MM-dd","picker-options":e.pickerBeginDateBefore},on:{change:e.selfDfinedFormTimePickerChange,clear:e.handleClear},model:{value:e.selfDfinedForm.chooseDate,callback:function(t){e.$set(e.selfDfinedForm,"chooseDate",t)},expression:"selfDfinedForm.chooseDate"}})],1),n("el-form-item",{staticClass:"firstEntryDate",attrs:{label:"入院日期"}},[n("el-date-picker",{staticClass:"timepicker itemContent",attrs:{type:"date","value-format":"yyyy-MM-dd","range-separator":"至","picker-options":e.pickerBeginDateBefore},on:{clear:e.handleClear},model:{value:e.selfDfinedForm.firstEntryDate,callback:function(t){e.$set(e.selfDfinedForm,"firstEntryDate",t)},expression:"selfDfinedForm.firstEntryDate"}})],1),n("el-form-item",{staticClass:"outHospitalDate",attrs:{label:"出院日期"}},[n("el-date-picker",{staticClass:"timepicker itemContent",attrs:{type:"date","value-format":"yyyy-MM-dd","range-separator":"至","picker-options":e.pickerBeginDateBefore},on:{clear:e.handleClear},model:{value:e.selfDfinedForm.outHospitalDate,callback:function(t){e.$set(e.selfDfinedForm,"outHospitalDate",t)},expression:"selfDfinedForm.outHospitalDate"}})],1),n("el-form-item",{staticClass:"chooseDate",attrs:{label:"就诊年龄段"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择就诊年龄段"},model:{value:e.selfDfinedForm.ageRanges,callback:function(t){e.$set(e.selfDfinedForm,"ageRanges",t)},expression:"selfDfinedForm.ageRanges"}},[n("el-option",{attrs:{label:"全部年龄",value:""}}),e._l(e.ageRangesLabList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.ageRange,value:e.ageValue}})}))],2)],1),n("el-form-item",{staticClass:"label",attrs:{label:"科室"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择科室",filterable:"",clearable:""},on:{change:e.drapSelectChangeFn},model:{value:e.initSelectValue,callback:function(t){e.initSelectValue=t},expression:"initSelectValue"}},e._l(e.DepartmentList,(function(e){return n("el-option",{key:e.departmentCode+e.departmentName,attrs:{label:e.departmentName+"("+e.yljgmc+")",value:e.departmentCode+"-"+e.yljgdm}})})),1)],1),n("el-form-item",{staticClass:"illnessClass",attrs:{label:"病区"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择病区",clearable:""},model:{value:e.selfDfinedForm.illnessArea,callback:function(t){e.$set(e.selfDfinedForm,"illnessArea",t)},expression:"selfDfinedForm.illnessArea"}},e._l(e.patientAreaList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.inpatientName,value:e.inpatientCode}})})),1)],1),e.showDepartmentClass?[n("el-form-item",{staticClass:"departmentClass",attrs:{label:"接诊医生"}},[n("el-select",{staticClass:"itemContent",attrs:{placeholder:"请选择活动区域"},model:{value:e.selfDfinedForm.attendingDoctor,callback:function(t){e.$set(e.selfDfinedForm,"attendingDoctor",t)},expression:"selfDfinedForm.attendingDoctor"}},e._l(e.dicList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.inpatientName,value:e.inpatientCode}})})),1)],1)]:e._e(),e.showDepartmentClass?e._e():n("el-form-item",{staticClass:"chooseDate",attrs:{label:""}}),n("el-form-item",{staticClass:"confirmClass itemContent"},[n("el-button",{attrs:{type:"primary"},on:{click:e.filterTodaytodayData}},[e._v(" 查询 ")])],1)],2),n("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.selfDfinedTableList,stripe:"",height:"63vh","header-cell-style":{background:"#ebeeff",color:"#606266",borderColor:"#ccc"}},on:{"row-dblclick":function(t,a,n){return e.clickPatientCard(t)}}},[n("template",{slot:"empty"},[n("p",[e._v(e._s(e.tableHasDataText))])]),n("el-table-column",{attrs:{prop:"omrn",label:"门诊/住院号","min-width":"150",align:"left","header-align":"center","show-overflow-tooltip":!0}}),n("el-table-column",{attrs:{prop:"fullName",label:"患者姓名","min-width":"120",align:"left","header-align":"center","show-overflow-tooltip":!0}}),n("el-table-column",{attrs:{prop:"genderName",label:"性别",width:"90",align:"center","header-align":"center"}}),n("el-table-column",{attrs:{prop:"ageYear",label:"年龄",width:"90",align:"center","header-align":"center"}}),n("el-table-column",{attrs:{label:"出生日期","min-width":"100",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.birthDate?t.row.birthDate.substr(0,11):"")+" ")]}}],null,!1,341549818)}),n("el-table-column",{attrs:{prop:"currentDeptName",label:"就诊科室","min-width":"120",align:"center","header-align":"center"}}),n("el-table-column",{attrs:{label:"就诊病区","min-width":"120",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.currentWardName||"暂无数据")+" ")]}}],null,!1,2537862031)}),n("el-table-column",{attrs:{label:"接诊医生","min-width":"120",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.scheduledDoctorName||"暂无数据")+" ")]}}],null,!1,413577926)}),n("el-table-column",{attrs:{label:"就诊日期","min-width":"140",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.visitStartTime?t.row.visitStartTime.substr(0,11):"")+" ")]}}],null,!1,514661210)}),n("el-table-column",{attrs:{prop:"idcardNo",label:"证件号","min-width":"140",align:"center","header-align":"center","show-overflow-tooltip":!0}}),n("el-table-column",{attrs:{label:"联系电话","min-width":"120",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.bizRoleContactTelephone?t.row.bizRoleContactTelephone[0].contactNo:"--")+" ")]}}],null,!1,86886241)}),n("el-table-column",{attrs:{prop:"encounterStatusName",label:"就诊状态","min-width":"110",align:"center","header-align":"center"}}),n("el-table-column",{attrs:{label:"查阅","min-width":"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"handle"},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.clickPatientCard(t.row)}}},[e._v(" 查阅360 ")])],1)]}}],null,!1,710364781)})],2),n("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage2+1,"page-sizes":[50,100,500],"page-size":e.pageSize2,layout:"total, sizes, prev, pager, next, jumper",total:e.total2},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1):e._e()],2),e.selectTabCardList.length<=0&&e.isShowNodata&&1*e.suffererType!==3&&1*e.suffererType!==4?n("div",{staticClass:"noTimelineContentText"}):e._e()],1)},o=[],r=a("2909"),i=a("b85c"),s=a("1da1"),l=a("5530"),c=(a("96cf"),a("d3b7"),a("159b"),a("b0c0"),a("4ec9"),a("3ca3"),a("ddb0"),a("e9c4"),a("a15b"),a("ac1f"),a("1276"),a("4e82"),a("caad"),a("498a"),a("4de4"),a("99af"),a("5319"),a("2f62")),d=a("14a5"),u=a("e432"),f=a("76f9"),p=a("e9d3"),h=a("b2a1"),m={props:{dialogVisible:{type:Boolean},isComponent:{type:Boolean,default:!1}},data:function(){return{time:0,isShowNodata:!1,isShowTooltip:!1,showSearchInput:!1,iconMan:u,iconWoman:f,iMan:p,iWoman:h,suffererType:1,wardInfo:1,query_key:"",loading:!1,loginInfo:{},DepartmentList:[],departmentCode:"",yljgdm:"",initSelectValue:"",cardsInfoList:[],userPatientCardsInfoList:[],selectTabCardList:[],userPatientCardsInfoTotalPages:0,cardsInfoTotalPages:0,pageIndex:0,pageSize:100,userPatientCardsPageIndex:0,userPatientCardsPageSize:100,loadList:!1,showPop:!1,searchDataList:[],showGroupList:!1,enableGroupList:[],showAddGroup:!1,addGroupName:"",currentClickPatientNo:"",showAlFocusHandle:!1,departmentCodeListJson:"",tableContentList:this.$enum.tableContentList,todayForm:{chooseDate:[],omrnLike:"",fullNameLike:"",attendingDoctor:""},rememberRow:{},rememberFilter:{},todayDataTableList:[],tableHasDataText:"",currentPage1:0,total1:0,pageSize1:50,showDepartmentClass:!0,pickerBeginDateBefore:{disabledDate:function(e){return e.getTime()>Date.now()}},selfDfinedForm:{omrnLike:"",fullNameLike:"",sexType:"",diagnose:"",chooseDate:[],firstEntryDate:"",outHospitalDate:"",ageRanges:"",attendingDoctor:"",illnessArea:""},ageRangesLabList:this.$enum.ageRanges(),selfDfinedTableList:[],currentPage2:0,total2:0,pageSize2:50,patientAreaList:[],dicList:[],blockTimePick:!1}},computed:Object(l["a"])({},Object(c["c"])(["userMessage"])),watch:{initSelectValue:{handler:function(e){sessionStorage.setItem("cardPageInstitutionInfo",e)}},deep:!0,userMessage:{handler:function(e){"doctor"===this.userMessage.roleTypeCode&&(this.showDepartmentClass=!1)}},"selfDfinedForm.firstEntryDate":{handler:function(e){e?(this.selfDfinedForm.chooseDate?(this.$set(this.selfDfinedForm.chooseDate,0,"".concat(e," 00:00:00")),this.$set(this.selfDfinedForm.chooseDate,1,"".concat(e," 23:59:59"))):(this.selfDfinedForm.chooseDate=[],this.selfDfinedForm.chooseDate[0]="".concat(e," 00:00:00"),this.selfDfinedForm.chooseDate[1]="".concat(e," 23:59:59")),this.blockTimePick=!0):this.blockTimePick=!1},deep:!0}},destroyed:function(){Object(d["a"])()},created:function(){this.loginInfo=this.$storage.get("vuex").userMessage,this.suffererType=sessionStorage.getItem("suffererTypes")||1,this.rememberRow=JSON.parse(sessionStorage.getItem("rememberClickRowInfo"))||{},this.rememberFilter=JSON.parse(sessionStorage.getItem("rememberFilter"))||{},1*this.suffererType===3&&(this.todayForm.fullNameLike=this.rememberFilter.todayForm?this.rememberFilter.todayForm.fullNameLike:"",this.todayForm.chooseDate=this.rememberFilter.todayForm?this.rememberFilter.todayForm.chooseDate:"",this.todayForm.attendingDoctor=this.rememberFilter.todayForm?this.rememberFilter.todayForm.attendingDoctor:"",this.todayForm.omrnLike=this.rememberFilter.todayForm?this.rememberFilter.todayForm.omrnLike:"")},mounted:function(){this.getDepartmentList(sessionStorage.getItem("suffererTypes")||1),JSON.parse(localStorage.getItem("allSysConfig"))&&JSON.parse(localStorage.getItem("allSysConfig")).show_search_switch&&(this.showSearchInput=JSON.parse(localStorage.getItem("allSysConfig")).show_search_switch),document.getElementById("sufferer_list")&&document.getElementById("sufferer_list").addEventListener("scroll",this.handleScroll)},methods:{rowStyle:function(e){var t=e.row,a=this;if(a.rememberRow.combinationPersonId===t.combinationPersonId)return"rowStyle";this.$el.querySelector(".el-table__body-wrapper").scrollTop=this.rememberRow.scrollHeight},onMouseOver:function(e){e.length<=11?this.isShowTooltip=!0:this.isShowTooltip=!1},handleSuffererTypeChange:function(e){this.getDepartmentList(e)},handleChangeTab:function(e){var t=this;sessionStorage.setItem("suffererTypes",this.suffererType),this.$refs.filterPart.$el.style.boxShadow="unset",1*this.suffererType===1?"doctor"===this.userMessage.roleTypeCode?this.getcardsInfo(this.loginInfo.usercode):this.getcardsInfo():1*this.suffererType===2?this.getcardsInfo(this.loginInfo.usercode):1*this.suffererType!==3&&1*this.suffererType!==4||(this.initDorctorSelect(),1*this.suffererType===4&&this.initpatientAreaList(),"doctor"===this.userMessage.roleTypeCode?this.loadTodayData(this.loginInfo.usercode):this.loadTodayData()),this.$nextTick((function(){t.$refs.table&&t.$refs.table.doLayout()}))},initDorctorSelect:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,o,s,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a={code:"hdw_emp",categoryCode:e.departmentCode,hospitalSoid:e.userMessage.jgdm},t.next=4,e.$api.apiServiceDictList(a);case 4:n=t.sent,o=n.data,e.selectAll=o,o&&o.length>0&&(s=[],o.forEach((function(e){var t={};t.inpatientCode=e.id,t.inpatientName=e.name,s.push(t)})),l=function(){var e,t=new Map,a=Object(i["a"])(s);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.has(n.inpatientCode)||t.set(n.inpatientCode,n)}}catch(o){a.e(o)}finally{a.f()}return Object(r["a"])(t.values())},c=l(),e.dicList=c),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},initpatientAreaList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getUserInpatientAreaForAdmin({userCode:e.loginInfo.usercode,yljgdm:e.loginInfo.jgdm});case 2:a=t.sent,n=a.data,n&&n.length>0&&(o=[],n.forEach((function(e){var t={};t.inpatientCode=e.inpatientCode,t.inpatientName=e.inpatientName,o.push(t)})),s=function(){var e,t=new Map,a=Object(i["a"])(o);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.has(n.inpatientCode)||t.set(n.inpatientCode,n)}}catch(s){a.e(s)}finally{a.f()}return Object(r["a"])(t.values())},l=s(),e.patientAreaList=l);case 5:case"end":return t.stop()}}),t)})))()},handleSizeChange1:function(e){this.pageSize1=e,this.handleChangeTab()},handleCurrentChange1:function(e){this.currentPage1=e-1,this.handleChangeTab()},handleSizeChange2:function(e){this.pageSize2=e,this.handleChangeTab()},handleCurrentChange2:function(e){this.currentPage2=e-1,this.handleChangeTab()},handleClear:function(){var e={todayForm:{fullNameLike:this.todayForm.fullNameLike,chooseDate:this.todayForm.chooseDate,attendingDoctor:this.todayForm.attendingDoctor,omrnLike:this.todayForm.omrnLike}};sessionStorage.setItem("rememberFilter",JSON.stringify(e))},timePickerChange:function(e){e&&e[0]===e[1]&&(this.todayForm.chooseDate[0]="".concat(this.todayForm.chooseDate[0]," 00:00:00"),this.todayForm.chooseDate[1]="".concat(this.todayForm.chooseDate[1]," 23:59:59"))},selfDfinedFormTimePickerChange:function(e){e&&e[0]===e[1]&&(this.selfDfinedForm.chooseDate[0]="".concat(this.selfDfinedForm.chooseDate[0]," 00:00:00"),this.selfDfinedForm.chooseDate[1]="".concat(this.selfDfinedForm.chooseDate[1]," 23:59:59"))},filterTodaytodayData:function(){if(1*this.suffererType===3){var e={todayForm:{fullNameLike:this.todayForm.fullNameLike,chooseDate:this.todayForm.chooseDate,attendingDoctor:this.todayForm.attendingDoctor,omrnLike:this.todayForm.omrnLike}};sessionStorage.setItem("rememberFilter",JSON.stringify(e)),"doctor"===this.userMessage.roleTypeCode?this.loadTodayData(this.loginInfo.usercode,this.todayForm):this.loadTodayData(null,this.todayForm)}else 1*this.suffererType===4&&("doctor"===this.userMessage.roleTypeCode?this.loadTodayData(this.loginInfo.usercode,this.selfDfinedForm):this.loadTodayData(null,this.selfDfinedForm))},loadTodayData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.todayDataTableList=[],this.tableHasDataText="";var n=this.departmentCode;if("1000"===this.departmentCode){var o=[];this.DepartmentList.forEach((function(e){o.push(e.departmentCode)})),n=o.join(",")}var r={};if(1*this.suffererType===3){var i={hospitalSoid:this.yljgdm,encounterTypeNoIn:"1,3",omrnLike:a.omrnLike?a.omrnLike:"",fullNameLike:a.fullNameLike?a.fullNameLike:"",visitStartTimeGte:a.chooseDate?a.chooseDate[0]:"",visitStartTimeLt:a.chooseDate?a.chooseDate[1]:"",options:JSON.stringify({pageIndex:this.currentPage1,pageSize:this.pageSize1})};"1"===JSON.parse(localStorage.getItem("allSysConfig")).depart_or_iarea?i.currentWardNo=1*n===-1?"":n:i.currentDeptNoIn=1*n===-1?"":n,r=t?Object(l["a"])(Object(l["a"])({},i),{},{scheduledDoctorNo:t,encounterStatusIn:"WN10_152680,WN10_152681,WN10_152682"}):Object(l["a"])(Object(l["a"])({},i),{},{encounterStatusIn:"WN10_152680,WN10_152681,WN10_152682,WN10_959657,WN10_959655",scheduledDoctorNo:this.todayForm.attendingDoctor?1*this.todayForm.attendingDoctor===-1?"":this.todayForm.attendingDoctor:""})}if(1*this.suffererType===4){var s={currentWardNo:a.illnessArea?1*a.illnessArea===-1?"":a.illnessArea:"",hospitalSoid:this.yljgdm,encounterTypeNoIn:a.diagnose?a.diagnose:"",omrnLike:a.omrnLike?a.omrnLike:"",fullNameLike:a.fullNameLike?a.fullNameLike:"",visitStartTimeGte:a.chooseDate?a.chooseDate[0]:"",visitStartTimeLt:a.chooseDate?a.chooseDate[1]:"",visitEndTimeGte:a.outHospitalDate?"".concat(a.outHospitalDate," 00:00:00"):"",visitEndTimeLt:a.outHospitalDate?"".concat(a.outHospitalDate," 23:59:59"):"",genderCode:a.sexType,ageYearGte:a.ageRanges?a.ageRanges.split("-")[0]:"",ageYearLte:a.ageRanges?a.ageRanges.split("-")[1]:"",options:JSON.stringify({pageIndex:this.currentPage2,pageSize:this.pageSize2})};"1"===JSON.parse(localStorage.getItem("allSysConfig")).depart_or_iarea?s.currentWardNo=1*n===-1?"":n:s.currentDeptNoIn=1*n===-1?"":n,r=t?Object(l["a"])(Object(l["a"])({},s),{},{encounterStatusIn:"WN10_152680,WN10_152681,WN10_152682",scheduledDoctorNo:t}):Object(l["a"])(Object(l["a"])({},s),{},{encounterStatusIn:"WN10_152680,WN10_152681,WN10_152682,WN10_959657,WN10_959655",scheduledDoctorNo:a.attendingDoctor?1*a.attendingDoctor===-1?"":a.attendingDoctor:""})}return new Promise((function(t,a){e.$api.getZyjzlistByKsdmNew(r).then((function(t){var a=t.data&&t.data.content&&t.data.content.length>0?t.data.content:[],n=[];return a.length>0&&a.forEach((function(e){var t={patid:e.personId,jzlsh:e.encounterId,jzlb:e.encounterTypeNo,yljgdm:e.hospitalSoid,yexh:e.yexh||"0",brzt:1};n.push(t)})),a.sort((function(e,t){return e.bedNoNum-t.bedNoNum})),a.length<=0&&(e.tableHasDataText="无相关数据！"),1*e.suffererType===3?(e.todayDataTableList=a,e.total1=t.data.totalElements):1*e.suffererType===4&&(e.selfDfinedTableList=a,e.total2=t.data.totalElements),new Promise((function(t,a){var o=JSON.stringify(n);e.$api.getFzbzByJzlshList({jzdjCoreInfos:o}).then((function(t){if(t.data&&t.data.length>0){var a=[];t.data.forEach((function(e){a.push(e.jzlsh)})),e.todayDataTableList.forEach((function(t){a.includes(t.encounterId)&&e.$set(t,"showFollowed",!0)}))}}))}))}))}))},handleScroll:function(){var e=this,t=document.getElementById("sufferer_list"),a=t.clientHeight,n=t.scrollHeight,o=t.scrollTop;n-100<o+a&&!e.loadList&&(e.loadList=!0,console.log("bottom"),1*e.suffererType===1&&e.cardsInfoTotalPages-1>e.pageIndex&&(e.pageIndex++,e.getcardsInfo(null,"scroll")),1*e.suffererType===2&&e.userPatientCardsInfoTotalPages-1>e.userPatientCardsPageIndex&&(e.userPatientCardsPageIndex++,e.getcardsInfo(this.loginInfo.usercode,"scroll")))},loadTableInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,o,r,i,s,c,d,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.showPop=!0,""!==e.query_key.trim()){t.next=5;break}return e.$message({message:"请输入内容后查询",type:"warning"}),e.showPop=!0,t.abrupt("return",!1);case 5:return t.prev=5,a={},n={contactNo:e.query_key.trim(),encounterId:e.query_key.trim(),fullName:e.query_key.trim(),idcardNo:e.query_key.trim(),imrn:e.query_key.trim(),omrn:e.query_key.trim(),identityNo:e.query_key.trim(),pageIndex:0,pagesize:100},"doctor"===e.userMessage.roleTypeCode?a=Object(l["a"])(Object(l["a"])({},n),{},{scheduledDoctorNo:e.loginInfo.usercode}):"headOfDepartment"===e.userMessage.roleTypeCode?a=Object(l["a"])(Object(l["a"])({},n),{},{currentDeptNoIn:e.departmentCodeListJson}):"headOfFunDepartment"===e.userMessage.roleTypeCode&&(a=Object(l["a"])({},n)),t.next=11,e.$api.gethzxxSearchList(a);case 11:o=t.sent,r=[],i={},o.content.forEach((function(e){i[e.personId]?r.forEach((function(t){t.personId===e.personId&&t.allData.push(e)})):(r.push({personId:e.personId,allData:[e]}),i[e.personId]=e)})),s=[],r.forEach((function(e){e.allData.sort((function(e,t){return new Date(t.visitStartTime)-new Date(e.visitStartTime)})),s.push(e.allData[0])})),c=[],d={},s.forEach((function(e,t){e.idcardNo&&"NA"===e.idcardNo&&(e.idcardNo=t+"NA"),d[e.idcardNo]?c.forEach((function(t){t.idcardNo===e.idcardNo&&t.allData.push(e)})):(c.push({idcardNo:e.idcardNo,allData:[e]}),d[e.idcardNo]=e)})),u=[],c.forEach((function(e){e.allData.sort((function(e,t){return new Date(t.visitStartTime)-new Date(e.visitStartTime)})),u.push(e.allData[0])})),u.forEach((function(e){e.idcardNo&&-1!==e.idcardNo.indexOf("NA")&&(e.idcardNo="NA")})),u.sort((function(e,t){return new Date(t.visitStartTime)-new Date(e.visitStartTime)})),e.searchDataList=u,e.showPop=!1,e.$refs.pop.doShow(),1===u.length&&setTimeout((function(){e.clickData(u[0])}),500),t.next=33;break;case 30:t.prev=30,t.t0=t["catch"](5),console.log(t.t0);case 33:case"end":return t.stop()}}),t,null,[[5,30]])})))()},clickData:function(e,t,a){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return sessionStorage.setItem("currentEncounterId",e.encounterId),sessionStorage.removeItem("showFollowed"),sessionStorage.removeItem("patientIdIn"),a={content:[]},a.content.push(e),n.$store.commit("SET_PatientInfo",a),o=null,t.next=9,n.$api.queryPatient({patid:a.content[0].personId,jzlb:a.content[0].encounterTypeNo,yljgdm:a.content[0].hospitalSoid});case 9:o=t.sent,sessionStorage.setItem("patientIdIn",JSON.stringify(o)),n.$store.dispatch("getMenuList",{patientIdIn:o.data}).then((function(e){if(e&&e.length>0){var t=e.filter((function(e){return"2"!==e.moduleStatus}));n.$store.commit("SET_CurrentMenu",t[0]),n.$router.push({path:t[0].moduleCode}),n.$emit("update:dialogVisible",!1)}else n.$message({message:"未配置或菜单配置不正确",type:"warning"})}));case 12:case"end":return t.stop()}}),t)})))()},getDepartmentList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o,r,i,s,l,c,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,1*e!==4){a.next=13;break}return t.initSelectValue="",t.DepartmentList=[],t.departmentCode="",t.yljgdm="",a.next=8,t.$api.getAllDepartmentList({userCode:t.loginInfo.usercode,yljgdm:t.loginInfo.jgdm});case 8:o=a.sent,r=o.data,n=r,a.next=20;break;case 13:return i={},1*e===1?i.syfw="2":1*e===3&&(i.syfw="1"),a.next=17,t.$api.getDepartment(i);case 17:s=a.sent,l=s.data,n=l;case 20:t.DepartmentList=n,c=[],n&&n.length>0&&n.forEach((function(e){c.push(e.departmentCode)})),t.departmentCodeListJson=c.join(","),sessionStorage.setItem("cardPageInstitutionInfoList",t.departmentCodeListJson),sessionStorage.getItem("cardPageInstitutionInfo")?(d=!1,n&&n.length>0&&n.forEach((function(e){"".concat(e.departmentCode,"-").concat(e.yljgdm)===sessionStorage.getItem("cardPageInstitutionInfo")&&(d=!0)})),d?(t.initSelectValue=sessionStorage.getItem("cardPageInstitutionInfo"),t.departmentCode=t.initSelectValue.substr(0,t.initSelectValue.indexOf("-")),t.yljgdm=t.initSelectValue.substr(t.initSelectValue.indexOf("-")+1,t.initSelectValue.length)):n&&n.length>0&&(t.initSelectValue="".concat(n[0].departmentCode,"-").concat(n[0].yljgdm),t.departmentCode=n[0].departmentCode,t.yljgdm=n[0].yljgdm)):n&&n.length>0&&(t.initSelectValue="".concat(n[0].departmentCode,"-").concat(n[0].yljgdm),t.departmentCode=n[0].departmentCode,t.yljgdm=n[0].yljgdm),t.handleChangeTab(),a.next=32;break;case 29:a.prev=29,a.t0=a["catch"](0),console.log(a.t0);case 32:case"end":return a.stop()}}),a,null,[[0,29]])})))()},getcardsInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0;"scroll"!==a&&(this.userPatientCardsInfoList=[],this.cardsInfoList=[]);var n=this.departmentCode;if("1000"===this.departmentCode){var o=[];this.DepartmentList.forEach((function(e){o.push(e.departmentCode)})),n=o.join(",")}var r={};return 1*this.suffererType!==1&&1*this.suffererType!==2||(r=t?{hospitalSoid:this.yljgdm,encounterTypeNoIn:"4",encounterStatusIn:"WN10_959657,WN10_959655",scheduledDoctorNo:t,options:JSON.stringify({pageIndex:this.userPatientCardsPageIndex,pageSize:this.userPatientCardsPageSize})}:{hospitalSoid:this.yljgdm,encounterTypeNoIn:"4",encounterStatusIn:"WN10_959657,WN10_959655",options:JSON.stringify({pageIndex:this.pageIndex,pageSize:this.pageSize})}),"1"===JSON.parse(localStorage.getItem("allSysConfig")).depart_or_iarea?r.currentWardNo=n:r.currentDeptNoIn=n,new Promise((function(a,n){e.$api.getZyjzlistByKsdmNew(r).then((function(a){var n=a.data&&a.data.content&&a.data.content.length>0?a.data.content:[],o=[];n.length>0&&n.forEach((function(e){if(e.inpBed){if(e.bedNoNum=e.inpBed&&e.inpBed.length>0&&e.inpBed[0].bedNo?1*e.inpBed[0].bedNo.replace(/[^0-9]/gi,""):1e5,e.inpBed&&e.inpBed.length>0&&e.inpBed[0].bedNo&&isNaN(e.inpBed[0].bedNo)){var t=e.inpBed[0].bedNo.split(""),a=0;t.forEach((function(e){a+=e.charCodeAt()})),e.bedNoNum+=a/1e6}}else if(e.bedNoNum=e.inpatBedInUse&&e.inpatBedInUse.length>0&&e.inpatBedInUse[0].bedNo?1*e.inpatBedInUse[0].bedNo.replace(/[^0-9]/gi,""):1e5,e.inpatBedInUse&&e.inpatBedInUse.length>0&&e.inpatBedInUse[0].bedNo&&isNaN(e.inpatBedInUse[0].bedNo)){var n=e.inpatBedInUse[0].bedNo.split(""),r=0;n.forEach((function(e){r+=e.charCodeAt()})),e.bedNoNum+=r/1e6}var i={patid:e.personId,jzlsh:e.encounterId,jzlb:e.encounterTypeNo,yljgdm:e.hospitalSoid,yexh:e.yexh||"0",brzt:1};o.push(i)})),n.sort((function(e,t){return e.bedNoNum-t.bedNoNum})),t?(e.userPatientCardsInfoList=e.userPatientCardsInfoList.concat(n),e.userPatientCardsInfoTotalPages=a.data.totalPages):(e.cardsInfoList=e.cardsInfoList.concat(n),e.cardsInfoTotalPages=a.data.totalPages),e.loadList=!1,e.renderGroupInfo(JSON.stringify(o),!!t)}))}))},drapSelectChangeFn:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.cardsInfoList=[],e.userPatientCardsInfoList=[],e.pageIndex=0,e.userPatientCardsPageIndex=0,e.departmentCode=e.initSelectValue.substr(0,e.initSelectValue.indexOf("-")),e.yljgdm=e.initSelectValue.substr(e.initSelectValue.indexOf("-")+1,e.initSelectValue.length),e.handleChangeTab();case 7:case"end":return t.stop()}}),t)})))()},renderGroupInfo:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(n,o){t.$api.getFzbzByJzlshList({jzdjCoreInfos:e}).then((function(e){if(e.data&&e.data.length>0){var n=[];e.data.forEach((function(e){n.push(e.jzlsh)})),a?t.userPatientCardsInfoList.forEach((function(e){n.includes(e.encounterId)&&t.$set(e,"showFollowed",!0)})):t.cardsInfoList.forEach((function(e){n.includes(e.encounterId)&&t.$set(e,"showFollowed",!0)}))}1*t.suffererType===1?"doctor"===t.userMessage.roleTypeCode?t.selectTabCardList=t.userPatientCardsInfoList:t.selectTabCardList=t.cardsInfoList:1*t.suffererType===2&&(t.selectTabCardList=t.userPatientCardsInfoList),t.time++,1===t.time&&(t.isShowNodata=!0,t.time=0)}))}))},handleShowFocus:function(e){var t=this;this.showAddGroup=!1,this.currentClickPatientNo="".concat(e.encounterId,"+").concat(e.encounterTypeNo);var a={patidGuid:this.currentClickPatientNo};return new Promise((function(e,n){t.$api.getEnableUserGroup(a).then((function(e){t.enableGroupList=e.data,t.enableGroupList.forEach((function(e){t.$set(e,"checked",!1)})),t.showGroupList=!0})).catch((function(e){console.log(e)}))}))},confirmAddGroup:function(){for(var e=this,t=0;t<this.enableGroupList.length;t++)if(this.enableGroupList[t].groupName===this.addGroupName.trim())return this.$message.warning("已有相同分组，请勿重复创建"),!1;var a={groupName:this.addGroupName.trim()};return new Promise((function(t,n){e.$api.addUserGroup(a).then((function(t){200===t.status&&(e.enableGroupList.push(t.data),e.showAddGroup=!1,e.$message({message:"新增分组成功",type:"success"}))}))}))},confirmFocus:function(e){var t=this;return new Promise((function(a,n){t.$api.queryPatient({patid:e.personId,jzlb:e.encounterTypeNo,yljgdm:e.hospitalSoid}).then((function(e){var a=[];if(t.enableGroupList.forEach((function(e){e.checked&&a.push({groupId:e.id,jzlshGuid:t.currentClickPatientNo,yexh:"0"})})),0===a.length)return t.$message.warning("请至少选择一个分组"),!1;t.$api.updatePatidGroup({patidList:e.data,jzlshGroupList:JSON.stringify(a)}).then((function(e){t.showGroupList=!1,1*t.suffererType===1?(t.pageIndex=0,t.cardsInfoList=[],t.getcardsInfo()):1*t.suffererType===2&&(t.userPatientCardsInfoList=[],t.userPatientCardsPageIndex=0,t.getcardsInfo(t.loginInfo.usercode)),t.$message({message:"关注成功",type:"success"})})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}))},handleAlFocus:function(e){this.showAddGroup=!1,this.showAlFocusHandle=!this.showAlFocusHandle,this.currentClickPatientNo="".concat(e.encounterId,"+").concat(e.encounterTypeNo)},handleEditGroup:function(e){var t=this,a={patidGuid:this.currentClickPatientNo};return new Promise((function(n,o){t.$api.getEnableUserGroup(a).then((function(a){t.enableGroupList=a.data,t.showGroupList=!0,t.showAlFocusHandle=!1,t.$api.getPatientGroup({patidList:"".concat(e.personId,"+").concat(e.encounterTypeNo,"+").concat(e.hospitalSoid),yexh:"0"}).then((function(e){var a=[];e.data.forEach((function(e){a.push(e.groupId)})),t.enableGroupList.forEach((function(e){a.includes(e.id)?t.$set(e,"checked",!0):t.$set(e,"checked",!1)}))}))})).catch((function(e){console.log(e)}))}))},cancelGroup:function(e){var t=this;return new Promise((function(a,n){t.$api.queryPatient({patid:e.personId,jzlb:e.encounterTypeNo,yljgdm:e.hospitalSoid}).then((function(e){t.$api.deletePatientGroup({patidList:e.data,yexh:"0"}).then((function(e){t.showAlFocusHandle=!1,1*t.suffererType===1?(t.cardsInfoList=[],t.pageIndex=0,t.getcardsInfo()):1*t.suffererType===2&&(t.userPatientCardsInfoList=[],t.userPatientCardsPageIndex=0,t.getcardsInfo(t.loginInfo.usercode)),t.$message({message:"取消关注成功",type:"success"})})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}))},clickPatientCard:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.$el.querySelector(".el-table__body-wrapper").scrollTop,o={combinationPersonId:e.combinationPersonId,scrollHeight:n},sessionStorage.setItem("rememberClickRowInfo",JSON.stringify(o)),r={content:[]},r.content.push(e),t.$store.commit("SET_PatientInfo",r),sessionStorage.setItem("showFollowed",e.showFollowed?"1":"0"),sessionStorage.setItem("currentEncounterId",e.encounterId),i=null,a.next=11,t.$api.queryPatient({patid:r.content[0].personId,jzlb:r.content[0].encounterTypeNo,yljgdm:r.content[0].hospitalSoid});case 11:i=a.sent,sessionStorage.setItem("patientIdIn",JSON.stringify(i)),t.$store.dispatch("getMenuList",{patientIdIn:i.data}).then((function(e){if(e&&e.length>0){var a=e.filter((function(e){return"2"!==e.moduleStatus}));t.$store.commit("SET_CurrentMenu",a[0]),t.$router.push({path:a[0].moduleCode}),t.$emit("update:dialogVisible",!1)}else t.$message({message:"未配置或菜单配置不正确",type:"warning"})}));case 14:case"end":return a.stop()}}),a)})))()}}},g=m,b=(a("1f4a"),a("2877")),y=Object(b["a"])(g,n,o,!1,null,"5563aec1",null);t["default"]=y.exports},"6d61":function(e,t,a){"use strict";var n=a("23e7"),o=a("da84"),r=a("e330"),i=a("94ca"),s=a("6eeb"),l=a("f183"),c=a("2266"),d=a("19aa"),u=a("1626"),f=a("861d"),p=a("d039"),h=a("1c7e"),m=a("d44e"),g=a("7156");e.exports=function(e,t,a){var b=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),v=b?"set":"add",C=o[e],w=C&&C.prototype,D=C,I={},k=function(e){var t=r(w[e]);s(w,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!f(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return y&&!f(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!f(e))&&t(this,0===e?0:e)}:function(e,a){return t(this,0===e?0:e,a),this})},N=i(e,!u(C)||!(y||w.forEach&&!p((function(){(new C).entries().next()}))));if(N)D=a.getConstructor(t,e,b,v),l.enable();else if(i(e,!0)){var _=new D,S=_[v](y?{}:-0,1)!=_,T=p((function(){_.has(1)})),x=h((function(e){new C(e)})),L=!y&&p((function(){var e=new C,t=5;while(t--)e[v](t,t);return!e.has(-0)}));x||(D=t((function(e,t){d(e,w);var a=g(new C,e,D);return void 0!=t&&c(t,a[v],{that:a,AS_ENTRIES:b}),a})),D.prototype=w,w.constructor=D),(T||L)&&(k("delete"),k("has"),b&&k("get")),(L||S)&&k(v),y&&w.clear&&delete w.clear}return I[e]=D,n({global:!0,forced:D!=C},I),m(D,e),y||a.setStrong(D,e,b),D}},addb:function(e,t,a){var n=a("4dae"),o=Math.floor,r=function(e,t){var a=e.length,l=o(a/2);return a<8?i(e,t):s(e,r(n(e,0,l),t),r(n(e,l),t),t)},i=function(e,t){var a,n,o=e.length,r=1;while(r<o){n=r,a=e[r];while(n&&t(e[n-1],a)>0)e[n]=e[--n];n!==r++&&(e[n]=a)}return e},s=function(e,t,a,n){var o=t.length,r=a.length,i=0,s=0;while(i<o||s<r)e[i+s]=i<o&&s<r?n(t[i],a[s])<=0?t[i++]:a[s++]:i<o?t[i++]:a[s++];return e};e.exports=r},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("d9e2");var n=a("06c5");function o(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=Object(n["a"])(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(l)throw i}}}}},bb2f:function(e,t,a){var n=a("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d86b:function(e,t,a){var n=a("d039");e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},d998:function(e,t,a){var n=a("342f");e.exports=/MSIE|Trident/.test(n)},f183:function(e,t,a){var n=a("23e7"),o=a("e330"),r=a("d012"),i=a("861d"),s=a("1a2d"),l=a("9bf2").f,c=a("241c"),d=a("057f"),u=a("4fad"),f=a("90e3"),p=a("bb2f"),h=!1,m=f("meta"),g=0,b=function(e){l(e,m,{value:{objectID:"O"+g++,weakData:{}}})},y=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,m)){if(!u(e))return"F";if(!t)return"E";b(e)}return e[m].objectID},v=function(e,t){if(!s(e,m)){if(!u(e))return!0;if(!t)return!1;b(e)}return e[m].weakData},C=function(e){return p&&h&&u(e)&&!s(e,m)&&b(e),e},w=function(){D.enable=function(){},h=!0;var e=c.f,t=o([].splice),a={};a[m]=1,e(a).length&&(c.f=function(a){for(var n=e(a),o=0,r=n.length;o<r;o++)if(n[o]===m){t(n,o,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},D=e.exports={enable:w,fastKey:y,getWeakData:v,onFreeze:C};r[m]=!0}}]);