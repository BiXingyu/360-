(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ba5e9146"],{"0cb2":function(t,e,n){var o=n("e330"),r=n("7b0b"),i=Math.floor,a=o("".charAt),s=o("".replace),c=o("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,o,u,p){var f=n+t.length,h=o.length,g=d;return void 0!==u&&(u=r(u),g=l),s(p,g,(function(r,s){var l;switch(a(s,0)){case"$":return"$";case"&":return t;case"`":return c(e,0,n);case"'":return c(e,f);case"<":l=u[c(s,1,-1)];break;default:var d=+s;if(0===d)return r;if(d>h){var p=i(d/10);return 0===p?r:p<=h?void 0===o[p-1]?a(s,1):o[p-1]+a(s,1):r}l=o[d-1]}return void 0===l?"":l}))}},"107c":function(t,e,n){var o=n("d039"),r=n("da84"),i=r.RegExp;t.exports=o((function(){var t=i("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},"14c3":function(t,e,n){var o=n("da84"),r=n("c65b"),i=n("825a"),a=n("1626"),s=n("c6b6"),c=n("9263"),l=o.TypeError;t.exports=function(t,e){var n=t.exec;if(a(n)){var o=r(n,t,e);return null!==o&&i(o),o}if("RegExp"===s(t))return r(c,t,e);throw l("RegExp#exec called on incompatible receiver")}},"2bb6":function(t,e,n){},5319:function(t,e,n){"use strict";var o=n("2ba4"),r=n("c65b"),i=n("e330"),a=n("d784"),s=n("d039"),c=n("825a"),l=n("1626"),d=n("5926"),u=n("50c4"),p=n("577e"),f=n("1d80"),h=n("8aa5"),g=n("dc4a"),C=n("0cb2"),m=n("14c3"),x=n("b622"),v=x("replace"),y=Math.max,T=Math.min,b=i([].concat),S=i([].push),w=i("".indexOf),I=i("".slice),P=function(t){return void 0===t?t:String(t)},_=function(){return"$0"==="a".replace(/./,"$0")}(),E=function(){return!!/./[v]&&""===/./[v]("a","$0")}(),O=!s((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));a("replace",(function(t,e,n){var i=E?"$":"$0";return[function(t,n){var o=f(this),i=void 0==t?void 0:g(t,v);return i?r(i,t,o,n):r(e,p(o),t,n)},function(t,r){var a=c(this),s=p(t);if("string"==typeof r&&-1===w(r,i)&&-1===w(r,"$<")){var f=n(e,a,s,r);if(f.done)return f.value}var g=l(r);g||(r=p(r));var x=a.global;if(x){var v=a.unicode;a.lastIndex=0}var _=[];while(1){var E=m(a,s);if(null===E)break;if(S(_,E),!x)break;var O=p(E[0]);""===O&&(a.lastIndex=h(s,u(a.lastIndex),v))}for(var R="",$=0,N=0;N<_.length;N++){E=_[N];for(var D=p(E[0]),k=y(T(d(E.index),s.length),0),M=[],F=1;F<E.length;F++)S(M,P(E[F]));var B=E.groups;if(g){var L=b([D],M,k,s);void 0!==B&&S(L,B);var W=p(o(r,void 0,L))}else W=C(D,s,k,M,B,r);k>=$&&(R+=I(s,$,k)+W,$=k+D.length)}return R+I(s,$)}]}),!O||!_||E)},"8aa5":function(t,e,n){"use strict";var o=n("6547").charAt;t.exports=function(t,e,n){return e+(n?o(t,e).length:1)}},9263:function(t,e,n){"use strict";var o=n("c65b"),r=n("e330"),i=n("577e"),a=n("ad6d"),s=n("9f7f"),c=n("5692"),l=n("7c73"),d=n("69f3").get,u=n("fce3"),p=n("107c"),f=c("native-string-replace",String.prototype.replace),h=RegExp.prototype.exec,g=h,C=r("".charAt),m=r("".indexOf),x=r("".replace),v=r("".slice),y=function(){var t=/a/,e=/b*/g;return o(h,t,"a"),o(h,e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),T=s.BROKEN_CARET,b=void 0!==/()??/.exec("")[1],S=y||b||T||u||p;S&&(g=function(t){var e,n,r,s,c,u,p,S=this,w=d(S),I=i(t),P=w.raw;if(P)return P.lastIndex=S.lastIndex,e=o(g,P,I),S.lastIndex=P.lastIndex,e;var _=w.groups,E=T&&S.sticky,O=o(a,S),R=S.source,$=0,N=I;if(E&&(O=x(O,"y",""),-1===m(O,"g")&&(O+="g"),N=v(I,S.lastIndex),S.lastIndex>0&&(!S.multiline||S.multiline&&"\n"!==C(I,S.lastIndex-1))&&(R="(?: "+R+")",N=" "+N,$++),n=new RegExp("^(?:"+R+")",O)),b&&(n=new RegExp("^"+R+"$(?!\\s)",O)),y&&(r=S.lastIndex),s=o(h,E?n:S,N),E?s?(s.input=v(s.input,$),s[0]=v(s[0],$),s.index=S.lastIndex,S.lastIndex+=s[0].length):S.lastIndex=0:y&&s&&(S.lastIndex=S.global?s.index+s[0].length:r),b&&s&&s.length>1&&o(f,s[0],n,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(s[c]=void 0)})),s&&_)for(s.groups=u=l(null),c=0;c<_.length;c++)p=_[c],u[p[0]]=s[p[1]];return s}),t.exports=g},"9f7f":function(t,e,n){var o=n("d039"),r=n("da84"),i=r.RegExp,a=o((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),s=a||o((function(){return!i("a","y").sticky})),c=a||o((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}));t.exports={BROKEN_CARET:c,MISSED_STICKY:s,UNSUPPORTED_Y:a}},a4ee:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"medicalRecordInfos-wrap"},[n("el-card",{staticClass:"box-card navigationColor"},[n("div",{directives:[{name:"show",rawName:"v-show",value:(t.pdfContent||t.htmlContent)&&t.DWBContent&&t.DWBContent.textContent,expression:"\n        (pdfContent || htmlContent) && DWBContent && DWBContent.textContent\n      "}],staticClass:"chooseContentTypes"},[n("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:t.showContentTypes,callback:function(e){t.showContentTypes=e},expression:"showContentTypes"}},[n("el-radio-button",{attrs:{label:"originType"}},[t._v("原病历查看")]),n("el-radio-button",{attrs:{label:"textType"}},[t._v("段文本查看")])],1)],1),"originType"===t.showContentTypes?[t.pdfContent?[n("div",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[n("el-button-group",[n("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:t.prePage}},[t._v(" 上一页 ")]),n("el-button",{attrs:{type:"primary"},on:{click:t.nextPage}},[t._v(" 下一页 "),n("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-left":"5px"}})])],1),n("div",{staticClass:"pdf-page"},[t._v("("+t._s(t.pagePdf)+" / "+t._s(t.pageTotalPdf)+")")])],1),t.isOss?n("div",{staticClass:"text itemMed"},[n("iframe",{ref:"ossPdfIframe",staticStyle:{width:"100%",height:"76vh","padding-left":"15px"},attrs:{src:t.pdfContent+"#view=FitH,top&toolbar=0",frameborder:"0",allowfullscreen:"true",toolbar:"0"}})]):n("div",{staticClass:"text itemMed"},[n("pdf",{ref:"pdf",attrs:{src:t.pdfContent,page:t.pagePdf},on:{progress:function(e){t.loadedRatio=e},"num-pages":function(e){t.pageTotalPdf=e}}})],1)]:t._e(),t.htmlContent?[n("div",{staticClass:"headerMed",attrs:{slot:"header"},slot:"header"},[n("el-button-group",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.clickCollect(t.htmlValForCollect.originContent)}}},[t._v(" 收藏 ")])],1)],1),n("div",{ref:"htmlContents",staticClass:"HTMLContent itemMed",domProps:{innerHTML:t._s(t.htmlContent)}})]:t._e(),t.txtTypeContent?[n("div",{staticClass:"textTypeContentStyle",domProps:{innerHTML:t._s(t.txtTypeContent)}})]:t._e()]:t._e(),"textType"===t.showContentTypes?[t.DWBContent&&t.DWBContent.textContent?[n("div",{staticClass:"headerMed",attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"title"},[t._v("病历资料")]),n("el-button",{staticClass:"collectDWB",attrs:{type:"primary"},on:{click:function(e){return t.clickCollect(t.DWBContent.textContent)}}},[t._v(" 收藏 ")])],1),n("div",{staticClass:"text itemMed"},t._l(t.DWBContent.textContent,(function(e,o){return n("div",{key:o,staticClass:"examinePlace"},[e.emrSectionDisplayName?n("span",{staticClass:"title"},[t._v(" "+t._s(e.emrSectionDisplayName)+" ")]):t._e(),n("p",{staticClass:"contents"},[e.emrSectionPlainText?[e.emrSectionPlainText.indexOf("/oss")>-1?n("img",{staticClass:"doctorSignImg",attrs:{src:e.emrSectionPlainText}}):t._e(),e.emrSectionPlainText.indexOf("base64")>-1?n("img",{staticClass:"doctorSignImg",attrs:{src:e.emrSectionPlainText}}):t._e(),-1===e.emrSectionPlainText.indexOf("base64")&&-1===e.emrSectionPlainText.indexOf("/oss")?n("span",{domProps:{innerHTML:t._s(e.emrSectionPlainText)}}):t._e()]:t._e()],2)])})),0)]:t._e()]:t._e(),t.isShowNoContentData?[n("div",{staticClass:"noTimelineContentText"})]:t._e(),(t.pdfContent||t.htmlContent)&&t.DWBContent&&t.DWBContent.textContent&&t.documentsRewriter?n("div",{staticClass:"documentReWriter"},[n("span",[t._v("文档修改者 : ")]),n("span",[t._v(t._s(t.documentsRewriter))])]):t._e()],2)],1)},r=[],i=n("1da1"),a=n("5530"),s=(n("96cf"),n("d3b7"),n("159b"),n("ac1f"),n("5319"),n("e9c4"),n("858e")),c=n("2f62"),l={name:"medicalRecordInfos",components:{pdf:s["a"]},data:function(){return{page:1,pageTotal:1,loadedRatio:0,htmlContent:"",HTMLContentToSon:{},htmlValForCollect:{},documentsRewriter:"",pdfContent:"",list:[],pagePdf:1,pageTotalPdf:0,pdfValForCollect:{},txtTypeContent:"",DWBContent:{},commonEncounterId:"",commonHospitalSoid:"",commonEncounterTypeNo:"",showContentTypes:"originType",isOss:!1,isShowNoContentData:!1}},watch:{HTMLContentToSon:{handler:function(t,e){var n=this;if(this.DWBContent={},this.pdfContent="",this.htmlContent="",this.txtTypeContent="",this.pdfValForCollect={},this.htmlValForCollect={},this.isShowNoContentData=!1,t.content&&""===t.content[0].cdFormat)return this.isShowNoContentData=!0,!1;if(t&&t.originContent&&"HTML"===t.originContent[0].cdFormat)this.htmlValForCollect=t,-1!==t.originContent[0].cdContent.indexOf("ERROR")&&t.originContent[0].cdContent.length<100&&"ZY"===t.originContent[0].sysSoid&&(t.originContent[0].cdContent="旧系统暂无数据提供！"),this.htmlContent=t.originContent[0].cdContent;else if(t&&t.originContent&&"pdf"===t.originContent[0].cdFormat||t&&t.originContent&&"PDF"===t.originContent[0].cdFormat){this.pdfValForCollect=t;var o=window.CONFIG.baseUrl2.substr(0,window.CONFIG.baseUrl2.length-1),r=JSON.parse(localStorage.getItem("allSysConfig")).oss_service_url||JSON.parse(localStorage.getItem("allSysConfig")).ossServiceUrl;if(r||this.$message.error("该患者未配置oss_service_url,无法展示相关PDF"),this.list=[],t.originContent[0].emrResourceLocation&&t.originContent[0].emrResourceLocation.length>0){var i=t.originContent[0].emrResourceLocation;i.forEach((function(t){-1===t.indexOf("/oss")?n.list.push({url:o+t,isOss:!1}):n.list.push({url:r+t,isOss:!0})})),this.pdfContent=this.list[0].url,this.pagePdf=1,this.pageTotalPdf=i.length,this.isOss=this.list[0].isOss}}else if(t&&t.originContent&&"txt"===t.originContent[0].cdFormat||t&&t.originContent&&"txt"===t.originContent[0].cdFormat){var a=t.originContent[0].cdContent;a&&(a=a.replace(/\r\n/g,"<br/>").replace(/[\n]/g,"<br/>").replace(/( )/g,"&nbsp")),this.txtTypeContent=a}if(t&&t.textContent&&t.textContent.length>0&&!t.textContent[0].cdFormat){var s=JSON.parse(JSON.stringify(t));s.textContent.length>0&&s.textContent.forEach((function(t){t.emrSectionPlainText&&t.emrSectionPlainText.indexOf("/oss")>-1&&(t.emrSectionPlainText=JSON.parse(localStorage.getItem("allSysConfig")).sso_token_url+t.emrSectionPlainText),t.emrSectionPlainText&&n.$set(t,"emrSectionPlainText",t.emrSectionPlainText.replace(/\r\n/g,"<br/>").replace(/[\n]/g,"<br/>").replace(/( )/g,"&nbsp"))})),this.DWBContent=s}this.pdfContent||this.htmlContent||this.txtTypeContent?this.showContentTypes="originType":this.showContentTypes="textType"},deep:!0}},computed:Object(a["a"])({},Object(c["c"])(["userMessage","timeLineData","patientInfo"])),created:function(){if(this.$route.query.patientEmrId){this.commonEncounterId=this.$route.query.encounterId,this.commonHospitalSoid=this.$route.query.hospitalSoid,this.commonEncounterTypeNo=this.$route.query.encounterTypeNo;var t={patientEmrId:this.$route.query.patientEmrId,encounterTypeNo:this.$route.query.encounterTypeNo,hospitalSoid:this.$route.query.hospitalSoid};this.handleNodeClick(t,0)}},methods:{handleNodeClick:function(t){var e=arguments,n=this;return Object(i["a"])(regeneratorRuntime.mark((function o(){var r,i,s,c,l;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.length>1&&void 0!==e[1]?e[1]:0,r={hospitalSoid:t.hospitalSoid,patientEmrId:t.patientEmrId,encounterTypeNo:t.encounterTypeNo,pageIndex:"0",pageSize:"100"},o.next=4,n.$api.getEmrSectionList(r);case 4:return i=o.sent,i.content.length>0&&i.content.forEach((function(e){return e.patientEmrId=t.emrId})),s={textType:"textType",textContent:i.content},o.next=9,n.$api.getEmrContentList(r);case 9:c=o.sent,c.data.content.forEach((function(e){return e.patientEmrId=t.emrId})),l={originType:"originType",originContent:c.data.content},i.content.length<=0&&c.data.content.length<=0?(n.$message.warning("暂无数据"),n.HTMLContentToSon={content:[{cdFormat:""}]}):(n.HTMLContentToSon=Object(a["a"])(Object(a["a"])({},s),l),n.documentsRewriter=s.content[0].mrModifiedBy||"");case 13:case"end":return o.stop()}}),o)})))()},clickCollect:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var o,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(0!==t.length){n.next=3;break}return e.$message({message:"无相关文档可收藏",type:"warning"}),n.abrupt("return",!1);case 3:return o=t[0].patientEmrId?t[0].patientEmrId:e.$route.query.patientEmrId,r={userCode:e.userMessage.usercode,encounterId:e.commonEncounterId,hospitalSoid:e.commonHospitalSoid,encounterTypeNo:e.commonEncounterTypeNo,wdlb:1,patientEmrId:o},n.next=7,e.$api.addCollectEmr(r);case 7:i=n.sent,i.message&&e.$message({message:"收藏成功",type:"success"});case 9:case"end":return n.stop()}}),n)})))()},prePage:function(){var t=this.pagePdf;t=t>1?t-1:this.pageTotalPdf,this.pagePdf=t,this.pdfContent=this.list[this.pagePdf-1].url,this.isOss=this.list[this.pagePdf-1].isOss},nextPage:function(){var t=this.pagePdf;t=t<this.pageTotalPdf?t+1:1,this.pagePdf=t,this.pdfContent=this.list[this.pagePdf-1].url,this.isOss=this.list[this.pagePdf-1].isOss}}},d=l,u=(n("cf69"),n("2877")),p=Object(u["a"])(d,o,r,!1,null,"2683e444",null);e["default"]=p.exports},ac1f:function(t,e,n){"use strict";var o=n("23e7"),r=n("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},cf69:function(t,e,n){"use strict";n("2bb6")},d784:function(t,e,n){"use strict";n("ac1f");var o=n("e330"),r=n("6eeb"),i=n("9263"),a=n("d039"),s=n("b622"),c=n("9112"),l=s("species"),d=RegExp.prototype;t.exports=function(t,e,n,u){var p=s(t),f=!a((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),h=f&&!a((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[l]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return e=!0,null},n[p](""),!e}));if(!f||!h||n){var g=o(/./[p]),C=e(p,""[t],(function(t,e,n,r,a){var s=o(t),c=e.exec;return c===i||c===d.exec?f&&!a?{done:!0,value:g(e,n,r)}:{done:!0,value:s(n,e,r)}:{done:!1}}));r(String.prototype,t,C[0]),r(d,p,C[1])}u&&c(d[p],"sham",!0)}},fce3:function(t,e,n){var o=n("d039"),r=n("da84"),i=r.RegExp;t.exports=o((function(){var t=i(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}))}}]);